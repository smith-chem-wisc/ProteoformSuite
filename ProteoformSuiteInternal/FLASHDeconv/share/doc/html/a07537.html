<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenMS: PScore Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style_ini.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="OpenMS_75x55_transparent.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenMS
   &#160;<span id="projectnumber">2.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="a05822.html">OpenMS</a></li><li class="navelem"><a class="el" href="a07537.html">PScore</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="a07534.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">PScore Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of the <a class="el" href="a07537.html" title="Implementation of the PScore PSM scoring algorithm.">PScore</a> PSM scoring algorithm.  
 <a href="a07537.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a03143_source.html">OpenMS/ANALYSIS/RNPXL/PScore.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a2e398acec9e03ce3fe009b246a6f08b6"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07537.html#a2e398acec9e03ce3fe009b246a6f08b6">calculateIntensityRankInMZWindow</a> (const std::vector&lt; <a class="el" href="a00001.html#a12109">double</a> &gt; &amp;mz, const std::vector&lt; <a class="el" href="a00001.html#a12109">double</a> &gt; &amp;intensities, <a class="el" href="a00001.html#a12109">double</a> mz_window)</td></tr>
<tr class="memdesc:a2e398acec9e03ce3fe009b246a6f08b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate local (windowed) peak ranks.  <a href="a07537.html#a2e398acec9e03ce3fe009b246a6f08b6">More...</a><br /></td></tr>
<tr class="separator:a2e398acec9e03ce3fe009b246a6f08b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefe774a48547129ac0d984219ff6d120"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; std::vector&lt; <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07537.html#aefe774a48547129ac0d984219ff6d120">calculateRankMap</a> (const <a class="el" href="a05788.html#ga2dae071a15204cb37ead15ecd87a51ce">PeakMap</a> &amp;peak_map, <a class="el" href="a00001.html#a12109">double</a> mz_window=100)</td></tr>
<tr class="memdesc:aefe774a48547129ac0d984219ff6d120"><td class="mdescLeft">&#160;</td><td class="mdescRight">precalculated, windowed peak ranks for a whole experiment.  <a href="a07537.html#aefe774a48547129ac0d984219ff6d120">More...</a><br /></td></tr>
<tr class="separator:aefe774a48547129ac0d984219ff6d120"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae940407e1b52c10b22002a99bb1433c8"><td class="memItemLeft" align="right" valign="top">static std::map&lt; <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>, <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07537.html#ae940407e1b52c10b22002a99bb1433c8">calculatePeakLevelSpectra</a> (const <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &amp;spec, const std::vector&lt; <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a> &gt; &amp;ranks, <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a> min_level=1, <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a> max_level=9)</td></tr>
<tr class="memdesc:ae940407e1b52c10b22002a99bb1433c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates spectra for peak level between min_level to max_level and stores them in the map A spectrum of peak level n retains the (n+1) top intensity peaks in a sliding mz_window centered at each peak.  <a href="a07537.html#ae940407e1b52c10b22002a99bb1433c8">More...</a><br /></td></tr>
<tr class="separator:ae940407e1b52c10b22002a99bb1433c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81d6624d31655589901e46b5385270fd"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="a00001.html#a12109">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07537.html#a81d6624d31655589901e46b5385270fd">computePScore</a> (<a class="el" href="a00001.html#a12109">double</a> fragment_mass_tolerance, bool fragment_mass_tolerance_unit_ppm, const std::map&lt; <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>, <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &gt; &amp;peak_level_spectra, const std::vector&lt; <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &gt; &amp;theo_spectra, <a class="el" href="a00001.html#a12109">double</a> mz_window=100.0)</td></tr>
<tr class="memdesc:a81d6624d31655589901e46b5385270fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the <a class="el" href="a07537.html" title="Implementation of the PScore PSM scoring algorithm.">PScore</a> for a vector of theoretical spectra.  <a href="a07537.html#a81d6624d31655589901e46b5385270fd">More...</a><br /></td></tr>
<tr class="separator:a81d6624d31655589901e46b5385270fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab456d745ad1593addbdf397f5ea6b38b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="a00001.html#a12109">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07537.html#ab456d745ad1593addbdf397f5ea6b38b">computePScore</a> (<a class="el" href="a00001.html#a12109">double</a> fragment_mass_tolerance, bool fragment_mass_tolerance_unit_ppm, const std::map&lt; <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>, <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &gt; &amp;peak_level_spectra, const <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &amp;theo_spectrum, <a class="el" href="a00001.html#a12109">double</a> mz_window=100.0)</td></tr>
<tr class="memdesc:ab456d745ad1593addbdf397f5ea6b38b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the <a class="el" href="a07537.html" title="Implementation of the PScore PSM scoring algorithm.">PScore</a> for a single theoretical spectrum.  <a href="a07537.html#ab456d745ad1593addbdf397f5ea6b38b">More...</a><br /></td></tr>
<tr class="separator:ab456d745ad1593addbdf397f5ea6b38b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc7c6739a7195ec122efe7e15c608c24"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="a00001.html#a12109">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07537.html#adc7c6739a7195ec122efe7e15c608c24">massCorrectionTerm</a> (<a class="el" href="a00001.html#a12109">double</a> mass)</td></tr>
<tr class="separator:adc7c6739a7195ec122efe7e15c608c24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39277eef2246768eb46bcc0cf0ae563e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="a00001.html#a12109">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07537.html#a39277eef2246768eb46bcc0cf0ae563e">cleavageCorrectionTerm</a> (<a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a> cleavages, bool consecutive_cleavage)</td></tr>
<tr class="separator:a39277eef2246768eb46bcc0cf0ae563e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51f88d6f765425cc46f1ea01e0b27e40"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="a00001.html#a12109">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07537.html#a51f88d6f765425cc46f1ea01e0b27e40">modificationCorrectionTerm</a> (<a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a> modifications)</td></tr>
<tr class="separator:a51f88d6f765425cc46f1ea01e0b27e40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of the <a class="el" href="a07537.html" title="Implementation of the PScore PSM scoring algorithm.">PScore</a> PSM scoring algorithm. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a2e398acec9e03ce3fe009b246a6f08b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e398acec9e03ce3fe009b246a6f08b6">&#9670;&nbsp;</a></span>calculateIntensityRankInMZWindow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::vector&lt;<a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>&gt; calculateIntensityRankInMZWindow </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="a00001.html#a12109">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="a00001.html#a12109">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>intensities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00001.html#a12109">double</a>&#160;</td>
          <td class="paramname"><em>mz_window</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculate local (windowed) peak ranks. </p>
<p>The peak rank is defined as the number of neighboring peaks in +/- (mz_window/2) that have higher intensity The result can be used to efficiently filter spectra for top 1..n peaks in mass windows</p>
<dl class="section note"><dt>Note</dt><dd>ranks are zero based (highest intensity peak in window has rank 0)</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mz</td><td>m/z positions of the peaks </td></tr>
    <tr><td class="paramname">intensities</td><td>of the peaks </td></tr>
    <tr><td class="paramname">mz_window</td><td>window in Thomson centered at each peak </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae940407e1b52c10b22002a99bb1433c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae940407e1b52c10b22002a99bb1433c8">&#9670;&nbsp;</a></span>calculatePeakLevelSpectra()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::map&lt;<a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>, <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &gt; calculatePeakLevelSpectra </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ranks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>&#160;</td>
          <td class="paramname"><em>min_level</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>&#160;</td>
          <td class="paramname"><em>max_level</em> = <code>9</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates spectra for peak level between min_level to max_level and stores them in the map A spectrum of peak level n retains the (n+1) top intensity peaks in a sliding mz_window centered at each peak. </p>
<dl class="section note"><dt>Note</dt><dd>levels are zero based (level 0 has only the top intensity peaks for each window, level 1 the top and second most intensive one) </dd>
<dd>
min and max level are taken from the Andromeda publication but are similar to the <a class="el" href="a06681.html" title="Implementation of the Ascore For a given peptide sequence and its MS/MS spectrum it identifies the mo...">AScore</a> publication </dd></dl>

</div>
</div>
<a id="aefe774a48547129ac0d984219ff6d120"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefe774a48547129ac0d984219ff6d120">&#9670;&nbsp;</a></span>calculateRankMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::vector&lt;std::vector&lt;<a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>&gt; &gt; calculateRankMap </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a05788.html#ga2dae071a15204cb37ead15ecd87a51ce">PeakMap</a> &amp;&#160;</td>
          <td class="paramname"><em>peak_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00001.html#a12109">double</a>&#160;</td>
          <td class="paramname"><em>mz_window</em> = <code>100</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>precalculated, windowed peak ranks for a whole experiment. </p>
<p>The peak rank is defined as the number of neighboring peaks in +/- (mz_window/2) that have higher intensity</p>
<ol type="1">
<li>Each spectrum is subdivided into windows of size <code>mz_window</code>.</li>
<li>For each window, peak ranks are assigned using <a class="el" href="a07537.html#a2e398acec9e03ce3fe009b246a6f08b6" title="calculate local (windowed) peak ranks.">calculateIntensityRankInMZWindow()</a>.</li>
<li>A rank map is returned</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>ranks are zero based (top element has rank 0)</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">peak_map</td><td>Fragment spectra used for rank calculation. Typically a peak map after removal of all MS1 spectra. </td></tr>
    <tr><td class="paramname">mz_window</td><td>window in Thomson centered at each peak </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a39277eef2246768eb46bcc0cf0ae563e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39277eef2246768eb46bcc0cf0ae563e">&#9670;&nbsp;</a></span>cleavageCorrectionTerm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="a00001.html#a12109">double</a> cleavageCorrectionTerm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>&#160;</td>
          <td class="paramname"><em>cleavages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>consecutive_cleavage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>correction term for type of cleavage. For reference see the Andromeda source code. </p><dl class="section note"><dt>Note</dt><dd>constants used in the correction term might be instrument dependent </dd></dl>

</div>
</div>
<a id="ab456d745ad1593addbdf397f5ea6b38b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab456d745ad1593addbdf397f5ea6b38b">&#9670;&nbsp;</a></span>computePScore() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="a00001.html#a12109">double</a> computePScore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00001.html#a12109">double</a>&#160;</td>
          <td class="paramname"><em>fragment_mass_tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fragment_mass_tolerance_unit_ppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>, <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>peak_level_spectra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>theo_spectrum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00001.html#a12109">double</a>&#160;</td>
          <td class="paramname"><em>mz_window</em> = <code>100.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the <a class="el" href="a07537.html" title="Implementation of the PScore PSM scoring algorithm.">PScore</a> for a single theoretical spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fragment_mass_tolerance</td><td>mass tolerance for matching peaks </td></tr>
    <tr><td class="paramname">fragment_mass_tolerance_unit_ppm</td><td>whether Thomson or ppm is used </td></tr>
    <tr><td class="paramname">peak_level_spectra</td><td>spectra for different peak levels (=filtered by maximum rank). </td></tr>
    <tr><td class="paramname">theo_spectra</td><td>theoretical spectra as obtained e.g. from <a class="el" href="a08133.html" title="Generates theoretical spectra for peptides with various options.">TheoreticalSpectrumGenerator</a> </td></tr>
    <tr><td class="paramname">mz_window</td><td>window in Thomson centered at each peak </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a81d6624d31655589901e46b5385270fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81d6624d31655589901e46b5385270fd">&#9670;&nbsp;</a></span>computePScore() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="a00001.html#a12109">double</a> computePScore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00001.html#a12109">double</a>&#160;</td>
          <td class="paramname"><em>fragment_mass_tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fragment_mass_tolerance_unit_ppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; <a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>, <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>peak_level_spectra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="a05788.html#gac786e5620e6f7527d31f752a90dc23fe">PeakSpectrum</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>theo_spectra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00001.html#a12109">double</a>&#160;</td>
          <td class="paramname"><em>mz_window</em> = <code>100.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the <a class="el" href="a07537.html" title="Implementation of the PScore PSM scoring algorithm.">PScore</a> for a vector of theoretical spectra. </p>
<p>Similar to Andromeda, a vector of theoretical spectra can be provided that e.g. contain loss spectra or higher charge spectra depending on the sequence. The best score obtained by scoring all those theoretical spectra against the experimental ones is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fragment_mass_tolerance</td><td>mass tolerance for matching peaks </td></tr>
    <tr><td class="paramname">fragment_mass_tolerance_unit_ppm</td><td>whether Thomson or ppm is used </td></tr>
    <tr><td class="paramname">peak_level_spectra</td><td>spectra for different peak levels (=filtered by maximum rank). </td></tr>
    <tr><td class="paramname">theo_spectra</td><td>theoretical spectra as obtained e.g. from <a class="el" href="a08133.html" title="Generates theoretical spectra for peptides with various options.">TheoreticalSpectrumGenerator</a> </td></tr>
    <tr><td class="paramname">mz_window</td><td>window in Thomson centered at each peak </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adc7c6739a7195ec122efe7e15c608c24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc7c6739a7195ec122efe7e15c608c24">&#9670;&nbsp;</a></span>massCorrectionTerm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="a00001.html#a12109">double</a> massCorrectionTerm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00001.html#a12109">double</a>&#160;</td>
          <td class="paramname"><em>mass</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>additive correction terms used by Andromeda (pscore + massC + cleaveC + modC - 100). For reference see the Andromeda source code. </p><dl class="section note"><dt>Note</dt><dd>constants used in the correction term might be instrument dependent </dd></dl>

</div>
</div>
<a id="a51f88d6f765425cc46f1ea01e0b27e40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51f88d6f765425cc46f1ea01e0b27e40">&#9670;&nbsp;</a></span>modificationCorrectionTerm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="a00001.html#a12109">double</a> modificationCorrectionTerm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a>&#160;</td>
          <td class="paramname"><em>modifications</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>correction term for modification. For reference see the Andromeda source code. </p><dl class="section note"><dt>Note</dt><dd>constants used in the correction term might be instrument dependent </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 9 2019 15:06:55 for OpenMS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
