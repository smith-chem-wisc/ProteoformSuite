<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenMS: IndexedMzMLDecoder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style_ini.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="OpenMS_75x55_transparent.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenMS
   &#160;<span id="projectnumber">2.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="a05822.html">OpenMS</a></li><li class="navelem"><a class="el" href="a09293.html">IndexedMzMLDecoder</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="a09290.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">IndexedMzMLDecoder Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A class to analyze indexedmzML files and extract the offsets of individual tags.  
 <a href="a09293.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a03914_source.html">OpenMS/FORMAT/HANDLERS/IndexedMzMLDecoder.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:aa28fc427f0e22c1693ba55ef5a123660"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; std::pair&lt; std::string, std::streampos &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">OffsetVector</a></td></tr>
<tr class="memdesc:aa28fc427f0e22c1693ba55ef5a123660"><td class="mdescLeft">&#160;</td><td class="mdescRight">The vector containing binary offsets.  <a href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">More...</a><br /></td></tr>
<tr class="separator:aa28fc427f0e22c1693ba55ef5a123660"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a441b8ee4fd4f2990eb529800d7e3768f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00001.html#a12329">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a09293.html#a441b8ee4fd4f2990eb529800d7e3768f">parseOffsets</a> (<a class="el" href="a08769.html">String</a> filename, std::streampos indexoffset, <a class="el" href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">OffsetVector</a> &amp;spectra_offsets, <a class="el" href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">OffsetVector</a> &amp;chromatograms_offsets)</td></tr>
<tr class="memdesc:a441b8ee4fd4f2990eb529800d7e3768f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to extract the offsets of all spectra and chromatograms from an indexedmzML.  <a href="a09293.html#a441b8ee4fd4f2990eb529800d7e3768f">More...</a><br /></td></tr>
<tr class="separator:a441b8ee4fd4f2990eb529800d7e3768f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf5533eb957b6062545d3a2772b7fac0"><td class="memItemLeft" align="right" valign="top">std::streampos&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a09293.html#aaf5533eb957b6062545d3a2772b7fac0">findIndexListOffset</a> (<a class="el" href="a08769.html">String</a> filename, <a class="el" href="a00001.html#a12329">int</a> buffersize=1023)</td></tr>
<tr class="memdesc:aaf5533eb957b6062545d3a2772b7fac0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to extract the indexList offset from an indexedmzML.  <a href="a09293.html#aaf5533eb957b6062545d3a2772b7fac0">More...</a><br /></td></tr>
<tr class="separator:aaf5533eb957b6062545d3a2772b7fac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a94872cc9183969aacfc71a974d9d0af4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00001.html#a12329">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a09293.html#a94872cc9183969aacfc71a974d9d0af4">domParseIndexedEnd_</a> (std::string in, <a class="el" href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">OffsetVector</a> &amp;spectra_offsets, <a class="el" href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">OffsetVector</a> &amp;chromatograms_offsets)</td></tr>
<tr class="memdesc:a94872cc9183969aacfc71a974d9d0af4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract data from a string containing an &lt;indexList&gt; tag.  <a href="a09293.html#a94872cc9183969aacfc71a974d9d0af4">More...</a><br /></td></tr>
<tr class="separator:a94872cc9183969aacfc71a974d9d0af4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class to analyze indexedmzML files and extract the offsets of individual tags. </p>
<p>Specifically, this class allows one to extract the offsets of the &lt;indexList&gt; tag and of all &lt;spectrum&gt; and &lt;chromatogram&gt; tag using the indices found at the end of the indexedmzML XML structure.</p>
<p>While findIndexListOffset tries extracts the offset of the indexList tag from the last 1024 bytes of the file, this offset allows the function parseOffsets to extract all elements contained in the &lt;indexList&gt; tag and thus get access to all spectra and chromatogram offsets. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="aa28fc427f0e22c1693ba55ef5a123660"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa28fc427f0e22c1693ba55ef5a123660">&#9670;&nbsp;</a></span>OffsetVector</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt; std::pair&lt;std::string, std::streampos&gt; &gt; <a class="el" href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">OffsetVector</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The vector containing binary offsets. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a94872cc9183969aacfc71a974d9d0af4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94872cc9183969aacfc71a974d9d0af4">&#9670;&nbsp;</a></span>domParseIndexedEnd_()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00001.html#a12329">int</a> domParseIndexedEnd_ </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">OffsetVector</a> &amp;&#160;</td>
          <td class="paramname"><em>spectra_offsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">OffsetVector</a> &amp;&#160;</td>
          <td class="paramname"><em>chromatograms_offsets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract data from a string containing an &lt;indexList&gt; tag. </p>
<p>This function parses the contained &lt;offset&gt; tags inside the indexList tag and stores the contents in the spectra and chromatogram offset vectors.</p>
<p>This function expects an input string that contains a root XML tag and as one of its child an &lt;indexList&gt; tag as defined by the mzML 1.1.0 index wrapper schema. Usually the root would be an indexedmzML tag and _must_ contain an indexList tag, while the dx:mzML, indexListOffset and fileChecksum are optional(their presence is not checked).</p>
<p>Still this means, don't stick non-valid XML in here (e.g. non matching open/close tags). Usually this means that you will at least have to add an opening &lt;/indexedmzML&gt;. Valid input for this function would for example be:</p>
<div class="fragment"><div class="line">&lt;indexedmzML&gt;</div>
<div class="line">  &lt;indexList count=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">    &lt;index name=<span class="stringliteral">&quot;chromatogram&quot;</span>&gt;</div>
<div class="line">      &lt;offset idRef=<span class="stringliteral">&quot;1&quot;</span>&gt;9752&lt;/offset&gt;</div>
<div class="line">    &lt;/index&gt;</div>
<div class="line">  &lt;/indexList&gt;</div>
<div class="line">  &lt;indexListOffset&gt;26795&lt;/indexListOffset&gt;</div>
<div class="line">&lt;fileChecksum&gt;0&lt;/fileChecksum&gt;</div>
<div class="line">&lt;/indexedmzML&gt;</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td><a class="el" href="a08769.html" title="A more convenient string class.">String</a> containing the XML with a indexedmzML parent and an indexList child tag </td></tr>
    <tr><td class="paramname">spectra_offsets</td><td>Output vector containing the positions of all spectra in the file </td></tr>
    <tr><td class="paramname">chromatograms_offsets</td><td>Output vector containing the positions of all chromatograms in the file </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aaf5533eb957b6062545d3a2772b7fac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf5533eb957b6062545d3a2772b7fac0">&#9670;&nbsp;</a></span>findIndexListOffset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::streampos findIndexListOffset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a08769.html">String</a>&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00001.html#a12329">int</a>&#160;</td>
          <td class="paramname"><em>buffersize</em> = <code>1023</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tries to extract the indexList offset from an indexedmzML. </p>
<p>This function reads by default the last few (1024) bytes of the given input file and tries to read the content of the &lt;indexListOffset&gt; tag. The idea is that somewhere in the last parts of the file specified by the input string, the string &lt;indexListOffset&gt;xxx&lt;/indexListOffset&gt; occurs. This function returns the xxx part converted to an integer.</p>
<dl class="section note"><dt>Note</dt><dd>Since this function cannot determine where it will start reading the XML, no regular XML parser can be used for this. Therefore it uses regex to do its job. It matches the &lt;indexListOffset&gt; part and any numerical characters that follow.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Filename of the input indexedmzML file </td></tr>
    <tr><td class="paramname">buffersize</td><td>How many bytes of the input file should be searched for the tag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A positive integer containing the content of the indexListOffset tag, returns -1 in case of failure no tag was found (you can re-try with a larger buffersize but most likely its not an indexed mzML). Using -1 is what the reference docu recommends: <a href="http://en.cppreference.com/w/cpp/io/streamoff">http://en.cppreference.com/w/cpp/io/streamoff</a></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FileNotFound</td><td>is thrown if file cannot be found </td></tr>
    <tr><td class="paramname">ParseError</td><td>if offset cannot be parsed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a441b8ee4fd4f2990eb529800d7e3768f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a441b8ee4fd4f2990eb529800d7e3768f">&#9670;&nbsp;</a></span>parseOffsets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00001.html#a12329">int</a> parseOffsets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a08769.html">String</a>&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::streampos&#160;</td>
          <td class="paramname"><em>indexoffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">OffsetVector</a> &amp;&#160;</td>
          <td class="paramname"><em>spectra_offsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a09293.html#aa28fc427f0e22c1693ba55ef5a123660">OffsetVector</a> &amp;&#160;</td>
          <td class="paramname"><em>chromatograms_offsets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tries to extract the offsets of all spectra and chromatograms from an indexedmzML. </p>
<p>Given the start of the &lt;indexList&gt; element, this function tries to read this tag from the given the indexedmzML file. It stores the result in the spectra and chromatogram offset vectors.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Filename of the input indexedmzML file </td></tr>
    <tr><td class="paramname">indexoffset</td><td>Offset at which position in the file the XML tag "&lt;indexList" is expected to occur </td></tr>
    <tr><td class="paramname">spectra_offsets</td><td>Output vector containing the positions of all spectra in the file </td></tr>
    <tr><td class="paramname">chromatograms_offsets</td><td>Output vector containing the positions of all chromatograms in the file</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 in case of success and -1 otherwise (failure, no offset was found) </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 9 2019 15:06:43 for OpenMS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
