<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenMS: IsoSpecTotalProbWrapper Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style_ini.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="OpenMS_75x55_transparent.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenMS
   &#160;<span id="projectnumber">2.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="a05822.html">OpenMS</a></li><li class="navelem"><a class="el" href="a07953.html">IsoSpecTotalProbWrapper</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="a07950.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">IsoSpecTotalProbWrapper Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Create a p-set of configurations for a given p (that is, a set of configurations such that their probabilities sum up to p). The p in normal usage will usually be close to 1 (e.g. 0.99).  
 <a href="a07953.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a03296_source.html">OpenMS/CHEMISTRY/ISOTOPEDISTRIBUTION/IsoSpecWrapper.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for IsoSpecTotalProbWrapper:</div>
<div class="dyncontent">
 <div class="center">
  <img src="a07953.png" usemap="#IsoSpecTotalProbWrapper_map" alt=""/>
  <map id="IsoSpecTotalProbWrapper_map" name="IsoSpecTotalProbWrapper_map">
<area href="a07937.html" title="A convenience class for the IsoSpec algorithm - easier to use than the IsoSpecGeneratorWrapper classe..." alt="IsoSpecWrapper" shape="rect" coords="0,0,160,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aef6f5148b1c7fba0542f9c2d776bc129"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07953.html#aef6f5148b1c7fba0542f9c2d776bc129">IsoSpecTotalProbWrapper</a> (const std::vector&lt; <a class="el" href="a00001.html#a12329">int</a> &gt; &amp;isotopeNumbers, const std::vector&lt; <a class="el" href="a00001.html#a12329">int</a> &gt; &amp;atomCounts, const std::vector&lt; std::vector&lt; <a class="el" href="a00001.html#a12109">double</a> &gt; &gt; &amp;isotopeMasses, const std::vector&lt; std::vector&lt; <a class="el" href="a00001.html#a12109">double</a> &gt; &gt; &amp;isotopeProbabilities, <a class="el" href="a00001.html#a12109">double</a> p, bool do_p_trim=false)</td></tr>
<tr class="memdesc:aef6f5148b1c7fba0542f9c2d776bc129"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="a07953.html#aef6f5148b1c7fba0542f9c2d776bc129">More...</a><br /></td></tr>
<tr class="separator:aef6f5148b1c7fba0542f9c2d776bc129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae372973e7aa650b2f5c4fd2e80725263"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07953.html#ae372973e7aa650b2f5c4fd2e80725263">IsoSpecTotalProbWrapper</a> (const <a class="el" href="a07905.html">EmpiricalFormula</a> &amp;formula, <a class="el" href="a00001.html#a12109">double</a> p, bool do_p_trim=false)</td></tr>
<tr class="memdesc:ae372973e7aa650b2f5c4fd2e80725263"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the algorithm to run on an <a class="el" href="a07905.html" title="Representation of an empirical formula.">EmpiricalFormula</a>.  <a href="a07953.html#ae372973e7aa650b2f5c4fd2e80725263">More...</a><br /></td></tr>
<tr class="separator:ae372973e7aa650b2f5c4fd2e80725263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18455fdf2d35f891bc2f05e457ea3ddf"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="a07961.html">IsotopeDistribution</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07953.html#a18455fdf2d35f891bc2f05e457ea3ddf">run</a> () override final</td></tr>
<tr class="memdesc:a18455fdf2d35f891bc2f05e457ea3ddf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the algorithm.  <a href="a07953.html#a18455fdf2d35f891bc2f05e457ea3ddf">More...</a><br /></td></tr>
<tr class="separator:a18455fdf2d35f891bc2f05e457ea3ddf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_a07937"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_a07937')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="a07937.html">IsoSpecWrapper</a></td></tr>
<tr class="memitem:a988a86e8a4bfd894de20a7f4039d1a33 inherit pub_methods_a07937"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07937.html#a988a86e8a4bfd894de20a7f4039d1a33">~IsoSpecWrapper</a> ()</td></tr>
<tr class="separator:a988a86e8a4bfd894de20a7f4039d1a33 inherit pub_methods_a07937"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a0da0019e0395facbea7e1aa9ba69dd0b"><td class="memItemLeft" align="right" valign="top">IsoSpec::IsoLayeredGenerator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a07953.html#a0da0019e0395facbea7e1aa9ba69dd0b">ILG</a></td></tr>
<tr class="separator:a0da0019e0395facbea7e1aa9ba69dd0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Create a p-set of configurations for a given p (that is, a set of configurations such that their probabilities sum up to p). The p in normal usage will usually be close to 1 (e.g. 0.99). </p>
<p>An optimal p-set of isotopologues is the smallest set of isotopologues that, taken together, cover at least p of the probability space (that is, their probabilities sum up to at least p). This means that the computed spectrum is accurate to at least degree p, and that the L1 distance between the computed spectrum and the true spectrum is less than 1-p. The optimality of the p-set means that it contains the most probable configurations - any isotopologues outside of the returned p-set have lower intensity than the configurations in the p-set.</p>
<p>This is the method most users will want: the p parameter directly controls the accuracy of results.</p>
<p>Advanced usage note: The algorithm works by computing an optimal p'-set for a p' slightly larger than the requested p. By default these extra isotopologues are returned too (as they have to be computed anyway). It is possible to request that the extra configurations be discarded, using the do_p_trim parameter. This will *increase* the runtime and especially the memory usage of the algorithm, and should not be done unless there is a good reason to.</p>
<dl class="section note"><dt>Note</dt><dd>The eligible configurations are NOT guaranteed to be returned in any particular order. </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aef6f5148b1c7fba0542f9c2d776bc129"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef6f5148b1c7fba0542f9c2d776bc129">&#9670;&nbsp;</a></span>IsoSpecTotalProbWrapper() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a07953.html">IsoSpecTotalProbWrapper</a> </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="a00001.html#a12329">int</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>isotopeNumbers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="a00001.html#a12329">int</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>atomCounts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; <a class="el" href="a00001.html#a12109">double</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>isotopeMasses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; <a class="el" href="a00001.html#a12109">double</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>isotopeProbabilities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00001.html#a12109">double</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_p_trim</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">isotopeNumbers</td><td>A vector of how many isotopes each element has, e.g. [2, 2, 3]) </td></tr>
    <tr><td class="paramname">atomCounts</td><td>How many atoms of each we have [e.g. 12, 6, 6 for Glucose] </td></tr>
    <tr><td class="paramname">isotopeMasses</td><td>Array with the individual elements isotopic masses </td></tr>
    <tr><td class="paramname">isotopeProbabilities</td><td>Array with the individual elements isotopic probabilities </td></tr>
    <tr><td class="paramname">p</td><td>Total coverage of probability space desired, usually close to 1 (e.g. 0.99) </td></tr>
    <tr><td class="paramname">do_p_trim</td><td>Whether to discard extra configurations that have been computed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This constructor is only useful if you need to define non-standard abundances of isotopes, for other uses the one accepting <a class="el" href="a07905.html" title="Representation of an empirical formula.">EmpiricalFormula</a> is easier to use. </dd></dl>

</div>
</div>
<a id="ae372973e7aa650b2f5c4fd2e80725263"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae372973e7aa650b2f5c4fd2e80725263">&#9670;&nbsp;</a></span>IsoSpecTotalProbWrapper() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a07953.html">IsoSpecTotalProbWrapper</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a07905.html">EmpiricalFormula</a> &amp;&#160;</td>
          <td class="paramname"><em>formula</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00001.html#a12109">double</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_p_trim</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the algorithm to run on an <a class="el" href="a07905.html" title="Representation of an empirical formula.">EmpiricalFormula</a>. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a18455fdf2d35f891bc2f05e457ea3ddf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18455fdf2d35f891bc2f05e457ea3ddf">&#9670;&nbsp;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="a07961.html">IsotopeDistribution</a> run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run the algorithm. </p>
<p>This method will run the algorithm with parameters as set up by the constructor. It will return an <a class="el" href="a07961.html">IsotopeDistribution</a> containing the observed configurations. The configurations are explicitly stored in memory, which may become a problem when considering some especially large distributions. If this, or (a rather small) performance overhead is a concern, then the generator methods (see <a class="el" href="a07933.html" title="Interface for the IsoSpec algorithm - a generator of infinitely-resolved theoretical spectra.">IsoSpecGeneratorWrapper</a>) should be used instead.</p>
<p>This method is provided for convenience. As calling that method invalidates the object (the method should not be called again, nor anything other than destroying the object should be done with it), the most common usage pattern of <a class="el" href="a07933.html" title="Interface for the IsoSpec algorithm - a generator of infinitely-resolved theoretical spectra.">IsoSpecGeneratorWrapper</a> classes with the run method is:</p>
<div class="fragment"><div class="line">IsotopeDistribution dist = IsoSpecGeneratorWrapperSubclass(...).run();</div>
<div class="line"><span class="comment">// do something with dist;</span></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Calling this method invalidates the object! In future versions this limitation might be removed. </dd></dl>

<p>Implements <a class="el" href="a07937.html#a5842575c796c90f5d2fd3ae95c8da8cb">IsoSpecWrapper</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a0da0019e0395facbea7e1aa9ba69dd0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0da0019e0395facbea7e1aa9ba69dd0b">&#9670;&nbsp;</a></span>ILG</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IsoSpec::IsoLayeredGenerator ILG</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 9 2019 15:06:44 for OpenMS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
