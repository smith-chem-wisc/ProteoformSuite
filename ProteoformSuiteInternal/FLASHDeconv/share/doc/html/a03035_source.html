<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenMS: PeakIntegrator.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style_ini.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="OpenMS_75x55_transparent.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenMS
   &#160;<span id="projectnumber">2.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d1205d0e20af6628fc63aa9a15c8e1b.html">OpenMS</a></li><li class="navelem"><a class="el" href="dir_e84de74a814e2d784ece86a9507ac49b.html">ANALYSIS</a></li><li class="navelem"><a class="el" href="dir_c6635f180ee207a91344888318333dba.html">OPENSWATH</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">PeakIntegrator.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a03035.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//                   OpenMS -- Open-Source Mass Spectrometry</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Copyright The OpenMS Team -- Eberhard Karls University Tuebingen,</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// ETH Zurich, and Freie Universitaet Berlin 2002-2018.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// This software is released under a three-clause BSD license:</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//  * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//    notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//  * Redistributions in binary form must reproduce the above copyright</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//    notice, this list of conditions and the following disclaimer in the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//    documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//  * Neither the name of any author or any participating institution</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//    may be used to endorse or promote products derived from this software</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//    without specific prior written permission.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// For a full list of authors, refer to the file AUTHORS.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// ARE DISCLAIMED. IN NO EVENT SHALL ANY OF THE AUTHORS OR THE CONTRIBUTING</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// INSTITUTIONS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// $Maintainer: Douglas McCloskey, Pasquale Domenico Colaianni $</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// $Authors: Douglas McCloskey, Pasquale Domenico Colaianni $</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;OpenMS/config.h&gt;</span> <span class="comment">// OPENMS_DLLAPI</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a03512.html">OpenMS/CONCEPT/LogStream.h</a>&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a03566.html">OpenMS/DATASTRUCTURES/ConvexHull2D.h</a>&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a03593.html">OpenMS/DATASTRUCTURES/DefaultParamHandler.h</a>&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a03650.html">OpenMS/DATASTRUCTURES/String.h</a>&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a04223.html">OpenMS/KERNEL/MSChromatogram.h</a>&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a04229.html">OpenMS/KERNEL/MSSpectrum.h</a>&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a04271.html">OpenMS/MATH/MISC/EmgGradientDescent.h</a>&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">namespace </span><a class="code" href="a05822.html">OpenMS</a></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="a07305.html">   72</a></span>&#160;  <span class="keyword">class </span>OPENMS_DLLAPI <a class="code" href="a07305.html">PeakIntegrator</a> :</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">public</span> <a class="code" href="a08589.html">DefaultParamHandler</a></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="a07305.html">PeakIntegrator</a>();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="a07305.html">PeakIntegrator</a>();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">struct </span><a class="code" href="a07305.html#a07309">PeakArea</a></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    {</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="a07305.html#ae517bffd82b9428b4f1d9500ea01c04f">   90</a></span>&#160;      <span class="keywordtype">double</span> area = 0.0;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="a07305.html#a89f6abd564014faeff7cd20c340a9c7d">   94</a></span>&#160;      <span class="keywordtype">double</span> height = 0.0;</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="a07305.html#a109d04f17ed8a29581da1da877cd8a91">   98</a></span>&#160;      <span class="keywordtype">double</span> apex_pos = 0.0;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="a07305.html#a1ac98462432789437fe4e0bf9520fd82">  102</a></span>&#160;      <a class="code" href="a08549.html#abdcce0f11b8d73a2b4da5b1a00457d7b">ConvexHull2D::PointArrayType</a> <a class="code" href="a07305.html#a1ac98462432789437fe4e0bf9520fd82">hull_points</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    };</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">struct </span><a class="code" href="a07305.html#a07313">PeakBackground</a></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="a07305.html#ae517bffd82b9428b4f1d9500ea01c04f">  115</a></span>&#160;      <span class="keywordtype">double</span> area = 0.0;</div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="a07305.html#a89f6abd564014faeff7cd20c340a9c7d">  119</a></span>&#160;      <span class="keywordtype">double</span> height = 0.0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    };</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keyword">struct </span><a class="code" href="a07305.html#a07317">PeakShapeMetrics</a></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    {</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="a07305.html#a23409e6cc95e068709f109902662ea30">  133</a></span>&#160;      <span class="keywordtype">double</span> width_at_5 = 0.0;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="a07305.html#aa9c006f7ff4376fe5ffe2be13f5a42c7">  137</a></span>&#160;      <span class="keywordtype">double</span> width_at_10 = 0.0;</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="a07305.html#a426386a9590347f1e400c67bd3b2f87f">  141</a></span>&#160;      <span class="keywordtype">double</span> width_at_50 = 0.0;</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="a07305.html#ae50a4652a3096c4aafb4c7968cc05570">  145</a></span>&#160;      <span class="keywordtype">double</span> start_position_at_5 = 0.0;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="a07305.html#ad92548804cdc1dc8daa541c8eb7bd32c">  149</a></span>&#160;      <span class="keywordtype">double</span> start_position_at_10 = 0.0;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="a07305.html#ac1626b7e3cd395bf0656f5991cb3c766">  153</a></span>&#160;      <span class="keywordtype">double</span> start_position_at_50 = 0.0;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="a07305.html#ab5bb698c85176875aa7b7f7bb8f31b46">  157</a></span>&#160;      <span class="keywordtype">double</span> end_position_at_5 = 0.0;</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="a07305.html#a97a165f1d5bc711086ea31504ae53771">  161</a></span>&#160;      <span class="keywordtype">double</span> end_position_at_10 = 0.0;</div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="a07305.html#a46b734fc6d34bf148242321438f290cf">  165</a></span>&#160;      <span class="keywordtype">double</span> end_position_at_50 = 0.0;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="a07305.html#aaf61fefba7dbf239776d9050b500131a">  169</a></span>&#160;      <span class="keywordtype">double</span> total_width = 0.0;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="a07305.html#ac664f477fa38532b6519c103d9eeb942">  183</a></span>&#160;      <span class="keywordtype">double</span> tailing_factor = 0.0;</div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="a07305.html#adfbbcf8d0ce1dc07d8af1f07919eea0c">  193</a></span>&#160;      <span class="keywordtype">double</span> asymmetry_factor = 0.0;</div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="a07305.html#ac8f610062612cf55a9b927feaf40213f">  198</a></span>&#160;      <span class="keywordtype">double</span> slope_of_baseline = 0.0;</div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="a07305.html#a6804c3176237e7617d845954a06e2b5d">  203</a></span>&#160;      <span class="keywordtype">double</span> baseline_delta_2_height = 0.0;</div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="a07305.html#a33e3ab344e2804f18438c35febb31db7">  207</a></span>&#160;      <a class="code" href="a00001.html#a12329">Int</a> points_across_baseline = 0;</div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="a07305.html#a0d5751d37650f192bd79e44932c91d03">  211</a></span>&#160;      <a class="code" href="a00001.html#a12329">Int</a> points_across_half_height = 0;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    };</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span>* INTEGRATION_TYPE_INTENSITYSUM = <span class="stringliteral">&quot;intensity_sum&quot;</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="a07305.html#a11090ae05bc236b97609a33221c6fd37">  224</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span>* INTEGRATION_TYPE_TRAPEZOID = <span class="stringliteral">&quot;trapezoid&quot;</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="a07305.html#a5215f069e6f61759350f5976158a0fe3">  226</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span>* INTEGRATION_TYPE_SIMPSON = <span class="stringliteral">&quot;simpson&quot;</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="a07305.html#a8c0a4be87ecf22638af39e09032fa727">  228</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span>* BASELINE_TYPE_BASETOBASE = <span class="stringliteral">&quot;base_to_base&quot;</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="a07305.html#ab24a005ded7aa784bb642b86ceed074c">  230</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span>* BASELINE_TYPE_VERTICALDIVISION = <span class="stringliteral">&quot;vertical_division&quot;</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="a07305.html#ad08d5f3b93de0044a349116232c903eb">  232</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span>* BASELINE_TYPE_VERTICALDIVISION_MIN = <span class="stringliteral">&quot;vertical_division_min&quot;</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="a07305.html#a67aaa9969fc946fc5aac56dcf41a076f">  234</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keyword">const</span> <span class="keywordtype">char</span>* BASELINE_TYPE_VERTICALDIVISION_MAX = <span class="stringliteral">&quot;vertical_division_max&quot;</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="a07305.html#a07309">PeakArea</a> integratePeak(</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10073.html">MSChromatogram</a>&amp; chromatogram, <span class="keyword">const</span> <span class="keywordtype">double</span> left, <span class="keyword">const</span> <span class="keywordtype">double</span> right</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="a07305.html#a07309">PeakArea</a> integratePeak(</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10073.html">MSChromatogram</a>&amp; chromatogram, <a class="code" href="a10073.html#a4895afe86c2aa0747ae0411c58c82114">MSChromatogram::ConstIterator</a>&amp; left, <a class="code" href="a10073.html#a4895afe86c2aa0747ae0411c58c82114">MSChromatogram::ConstIterator</a>&amp; right</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="a07305.html#a07309">PeakArea</a> integratePeak(</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10097.html">MSSpectrum</a>&amp; spectrum, <span class="keyword">const</span> <span class="keywordtype">double</span> left, <span class="keyword">const</span> <span class="keywordtype">double</span> right</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="a07305.html#a07309">PeakArea</a> integratePeak(</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10097.html">MSSpectrum</a>&amp; spectrum, <a class="code" href="a10097.html#a4895afe86c2aa0747ae0411c58c82114">MSSpectrum::ConstIterator</a>&amp; left, <a class="code" href="a10097.html#a4895afe86c2aa0747ae0411c58c82114">MSSpectrum::ConstIterator</a>&amp; right</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="a07305.html#a07313">PeakBackground</a> estimateBackground(</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10073.html">MSChromatogram</a>&amp; chromatogram, <span class="keyword">const</span> <span class="keywordtype">double</span> left, <span class="keyword">const</span> <span class="keywordtype">double</span> right,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_apex_pos</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="a07305.html#a07313">PeakBackground</a> estimateBackground(</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10073.html">MSChromatogram</a>&amp; chromatogram, <a class="code" href="a10073.html#a4895afe86c2aa0747ae0411c58c82114">MSChromatogram::ConstIterator</a>&amp; left, <a class="code" href="a10073.html#a4895afe86c2aa0747ae0411c58c82114">MSChromatogram::ConstIterator</a>&amp; right,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_apex_pos</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="a07305.html#a07313">PeakBackground</a> estimateBackground(</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10097.html">MSSpectrum</a>&amp; spectrum, <span class="keyword">const</span> <span class="keywordtype">double</span> left, <span class="keyword">const</span> <span class="keywordtype">double</span> right,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_apex_pos</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="a07305.html#a07313">PeakBackground</a> estimateBackground(</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10097.html">MSSpectrum</a>&amp; spectrum, <a class="code" href="a10097.html#a4895afe86c2aa0747ae0411c58c82114">MSSpectrum::ConstIterator</a>&amp; left, <a class="code" href="a10097.html#a4895afe86c2aa0747ae0411c58c82114">MSSpectrum::ConstIterator</a>&amp; right,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_apex_pos</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="a07305.html#a07317">PeakShapeMetrics</a> calculatePeakShapeMetrics(</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10073.html">MSChromatogram</a>&amp; chromatogram, <span class="keyword">const</span> <span class="keywordtype">double</span> left, <span class="keyword">const</span> <span class="keywordtype">double</span> right,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_height, <span class="keyword">const</span> <span class="keywordtype">double</span> peak_apex_pos</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="a07305.html#a07317">PeakShapeMetrics</a> calculatePeakShapeMetrics(</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10073.html">MSChromatogram</a>&amp; chromatogram, <a class="code" href="a10073.html#a4895afe86c2aa0747ae0411c58c82114">MSChromatogram::ConstIterator</a>&amp; left, <a class="code" href="a10073.html#a4895afe86c2aa0747ae0411c58c82114">MSChromatogram::ConstIterator</a>&amp; right,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_height, <span class="keyword">const</span> <span class="keywordtype">double</span> peak_apex_pos</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="a07305.html#a07317">PeakShapeMetrics</a> calculatePeakShapeMetrics(</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10097.html">MSSpectrum</a>&amp; spectrum, <span class="keyword">const</span> <span class="keywordtype">double</span> left, <span class="keyword">const</span> <span class="keywordtype">double</span> right,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_height, <span class="keyword">const</span> <span class="keywordtype">double</span> peak_apex_pos</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="a07305.html#a07317">PeakShapeMetrics</a> calculatePeakShapeMetrics(</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keyword">const</span> <a class="code" href="a10097.html">MSSpectrum</a>&amp; spectrum, <a class="code" href="a10097.html#a4895afe86c2aa0747ae0411c58c82114">MSSpectrum::ConstIterator</a>&amp; left, <a class="code" href="a10097.html#a4895afe86c2aa0747ae0411c58c82114">MSSpectrum::ConstIterator</a>&amp; right,</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_height, <span class="keyword">const</span> <span class="keywordtype">double</span> peak_apex_pos</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordtype">void</span> getDefaultParameters(<a class="code" href="a08745.html">Param</a>&amp; params);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordtype">void</span> updateMembers_();</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> PeakContainerT&gt;</div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="a07305.html#aeea403d8136cb2ccbd862d15ba2b9c83">  543</a></span>&#160;    <a class="code" href="a07305.html#a07309">PeakArea</a> <a class="code" href="a07305.html#aeea403d8136cb2ccbd862d15ba2b9c83">integratePeak_</a>(<span class="keyword">const</span> PeakContainerT&amp; pc, <span class="keywordtype">double</span> left, <span class="keywordtype">double</span> right)<span class="keyword"> const</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <a class="code" href="a05816.html#ga45a74ea28109e7e1ed992fbd2ee97778">OPENMS_PRECONDITION</a>(left &lt;= right, <span class="stringliteral">&quot;Left peak boundary must be smaller than right boundary!&quot;</span>) <span class="comment">// otherwise the code below will segfault (due to PosBegin/PosEnd)</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      PeakContainerT emg_pc;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="keyword">const</span> PeakContainerT&amp; p = EMGPreProcess_(pc, emg_pc, left, right);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      std::function&lt;<a class="code" href="a00001.html#a12109">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      compute_peak_area_trapezoid = [&amp;p](<span class="keyword">const</span> <span class="keywordtype">double</span> left, <span class="keyword">const</span> <span class="keywordtype">double</span> right)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordtype">double</span> peak_area { 0.0 };</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">typename</span> PeakContainerT::ConstIterator it = p.PosBegin(left); it != p.PosEnd(right) - 1; ++it)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;          peak_area += ((it + 1)-&gt;getPos() - it-&gt;getPos()) * ((it-&gt;getIntensity() + (it + 1)-&gt;getIntensity()) / 2.0);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">return</span> peak_area;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      };</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      std::function&lt;<a class="code" href="a00001.html#a12109">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      compute_peak_area_intensity_sum = [&amp;p](<span class="keyword">const</span> <span class="keywordtype">double</span> left, <span class="keyword">const</span> <span class="keywordtype">double</span> right)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">// OPENMS_LOG_WARN &lt;&lt; &quot;WARNING: intensity_sum method is being used.&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordtype">double</span> peak_area { 0.0 };</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">typename</span> PeakContainerT::ConstIterator it = p.PosBegin(left); it != p.PosEnd(right); ++it)</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          peak_area += it-&gt;getIntensity();</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">return</span> peak_area;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      };</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <a class="code" href="a07305.html#a07309">PeakArea</a> pa;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      pa.<a class="code" href="a07305.html#a109d04f17ed8a29581da1da877cd8a91">apex_pos</a> = (left + right) / 2; <span class="comment">// initial estimate, to avoid apex being outside of [left,right]</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <a class="code" href="a05782.html#gaba0996d26f7be2572973245b51852757">UInt</a> n_points = std::distance(p.PosBegin(left), p.PosEnd(right));</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = p.PosBegin(left); it != p.PosEnd(right); ++it) <span class="comment">//OMS_CODING_TEST_EXCLUDE</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        pa.<a class="code" href="a07305.html#a1ac98462432789437fe4e0bf9520fd82">hull_points</a>.push_back(<a class="code" href="a08601.html">DPosition&lt;2&gt;</a>(it-&gt;getPos(), it-&gt;getIntensity()));</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">if</span> (pa.<a class="code" href="a07305.html#a89f6abd564014faeff7cd20c340a9c7d">height</a> &lt; it-&gt;getIntensity())</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          pa.<a class="code" href="a07305.html#a89f6abd564014faeff7cd20c340a9c7d">height</a> = it-&gt;getIntensity();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          pa.<a class="code" href="a07305.html#a109d04f17ed8a29581da1da877cd8a91">apex_pos</a> = it-&gt;getPos();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">if</span> (integration_type_ == INTEGRATION_TYPE_TRAPEZOID)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordflow">if</span> (n_points &gt;= 2)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          pa.<a class="code" href="a07305.html#ae517bffd82b9428b4f1d9500ea01c04f">area</a> = compute_peak_area_trapezoid(left, right);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (integration_type_ == INTEGRATION_TYPE_SIMPSON)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">if</span> (n_points == 2)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          <a class="code" href="a03512.html#a0649d2eea8e784aa7af65942f27a6174">OPENMS_LOG_WARN</a> &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;PeakIntegrator::integratePeak:&quot;</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="stringliteral">&quot;number of points is 2, falling back to `trapezoid`.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          pa.<a class="code" href="a07305.html#ae517bffd82b9428b4f1d9500ea01c04f">area</a> = compute_peak_area_trapezoid(left, right);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n_points &gt; 2)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          <span class="keywordflow">if</span> (n_points % 2)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            pa.<a class="code" href="a07305.html#ae517bffd82b9428b4f1d9500ea01c04f">area</a> = simpson_(p.PosBegin(left), p.PosEnd(right));</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;          }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="keywordtype">double</span> areas[4] = {-1.0, -1.0, -1.0, -1.0};</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            areas[0] = simpson_(p.PosBegin(left), p.PosEnd(right) - 1);   <span class="comment">// without last point</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            areas[1] = simpson_(p.PosBegin(left) + 1, p.PosEnd(right));   <span class="comment">// without first point</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">if</span> (p.begin() &lt;= p.PosBegin(left) - 1)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;              areas[2] = simpson_(p.PosBegin(left) - 1, p.PosEnd(right)); <span class="comment">// with one more point on the left</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="keywordflow">if</span> (p.PosEnd(right) &lt; p.end())</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;              areas[3] = simpson_(p.PosBegin(left), p.PosEnd(right) + 1); <span class="comment">// with one more point on the right</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <a class="code" href="a05782.html#gaba0996d26f7be2572973245b51852757">UInt</a> valids = 0;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; area : areas)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;              <span class="keywordflow">if</span> (area != -1.0)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;              {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                pa.<a class="code" href="a07305.html#ae517bffd82b9428b4f1d9500ea01c04f">area</a> += area;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                ++valids;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;              }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            pa.<a class="code" href="a07305.html#ae517bffd82b9428b4f1d9500ea01c04f">area</a> /= valids;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (integration_type_ == INTEGRATION_TYPE_INTENSITYSUM)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        pa.<a class="code" href="a07305.html#ae517bffd82b9428b4f1d9500ea01c04f">area</a> = compute_peak_area_intensity_sum(left, right);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="a08317.html">Exception::InvalidParameter</a>(__FILE__, __LINE__, OPENMS_PRETTY_FUNCTION, <span class="stringliteral">&quot;Please set a valid value for the parameter \&quot;integration_type\&quot;.&quot;</span>);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">return</span> pa;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> PeakContainerT&gt;</div>
<div class="line"><a name="l00647"></a><span class="lineno"><a class="line" href="a07305.html#a1d398adbb7b8be081b5efc3cd59f3c3e">  647</a></span>&#160;    <a class="code" href="a07305.html#a07313">PeakBackground</a> <a class="code" href="a07305.html#a1d398adbb7b8be081b5efc3cd59f3c3e">estimateBackground_</a>(</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="keyword">const</span> PeakContainerT&amp; pc, <span class="keywordtype">double</span> left, <span class="keywordtype">double</span> right,</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_apex_pos</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    )<span class="keyword"> const</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      PeakContainerT emg_pc;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keyword">const</span> PeakContainerT&amp; p = EMGPreProcess_(pc, emg_pc, left, right);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> int_l = p.PosBegin(left)-&gt;getIntensity();</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> int_r = (p.PosEnd(right) - 1)-&gt;getIntensity();</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> delta_int = int_r - int_l;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> delta_pos = (p.PosEnd(right) - 1)-&gt;getPos() - p.PosBegin(left)-&gt;getPos();</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> min_int_pos = int_r &lt;= int_l ? (p.PosEnd(right) - 1)-&gt;getPos() : p.PosBegin(left)-&gt;getPos();</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> delta_int_apex = std::fabs(delta_int) * std::fabs(min_int_pos - peak_apex_pos) / delta_pos;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keywordtype">double</span> area {0.0};</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordtype">double</span> height {0.0};</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordflow">if</span> (baseline_type_ == BASELINE_TYPE_BASETOBASE)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        height = std::min(int_r, int_l) + delta_int_apex;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordflow">if</span> (integration_type_ == INTEGRATION_TYPE_TRAPEZOID || integration_type_ == INTEGRATION_TYPE_SIMPSON)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;          <span class="comment">// formula for calculating the background using the trapezoidal rule</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          <span class="comment">// area = intensity_min*delta_pos + 0.5*delta_int*delta_pos;</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          area = delta_pos * (std::min(int_r, int_l) + 0.5 * std::fabs(delta_int));</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (integration_type_ == INTEGRATION_TYPE_INTENSITYSUM)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;          <span class="comment">// calculate the background using an estimator of the form</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;          <span class="comment">//    y = mx + b</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;          <span class="comment">//    where x = rt or mz, m = slope, b = left intensity</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;          <span class="comment">// sign of delta_int will determine line direction</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;          <span class="comment">// area += delta_int / delta_pos * (it-&gt;getPos() - left) + int_l;</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          <span class="keywordtype">double</span> pos_sum = 0.0; <span class="comment">// rt or mz</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = p.PosBegin(left); it != p.PosEnd(right); ++it) <span class="comment">//OMS_CODING_TEST_EXCLUDE</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            pos_sum += it-&gt;getPos();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          <a class="code" href="a05782.html#gaba0996d26f7be2572973245b51852757">UInt</a> n_points = std::distance(p.PosBegin(left), p.PosEnd(right));</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          <span class="comment">// We construct the background area as the sum of a rectangular part</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          <span class="comment">// and a triangle on top. The triangle is constructed as the sum of the</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          <span class="comment">// line&#39;s y value at each sampled point: \sum_{i=0}^{n} (x_i - x_0)  * m</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> rectangle_area = n_points * int_l;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> slope = delta_int / delta_pos;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> triangle_area = (pos_sum - n_points * p.PosBegin(left)-&gt;getPos()) * slope;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          area = triangle_area + rectangle_area;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (baseline_type_ == BASELINE_TYPE_VERTICALDIVISION || baseline_type_ == BASELINE_TYPE_VERTICALDIVISION_MIN)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        height = std::min(int_r, int_l);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">if</span> (integration_type_ == INTEGRATION_TYPE_TRAPEZOID || integration_type_ == INTEGRATION_TYPE_SIMPSON)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;          area = delta_pos * std::min(int_r, int_l);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (integration_type_ == INTEGRATION_TYPE_INTENSITYSUM)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;          area = std::min(int_r, int_l) * std::distance(p.PosBegin(left), p.PosEnd(right));;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (baseline_type_ == BASELINE_TYPE_VERTICALDIVISION_MAX)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        height = std::max(int_r, int_l);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">if</span> (integration_type_ == INTEGRATION_TYPE_TRAPEZOID || integration_type_ == INTEGRATION_TYPE_SIMPSON)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;          area = delta_pos * std::max(int_r, int_l);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (integration_type_ == INTEGRATION_TYPE_INTENSITYSUM)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;          area = std::max(int_r, int_l) * std::distance(p.PosBegin(left), p.PosEnd(right));</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="a08317.html">Exception::InvalidParameter</a>(__FILE__, __LINE__, OPENMS_PRETTY_FUNCTION, <span class="stringliteral">&quot;Please set a valid value for the parameter \&quot;baseline_type\&quot;.&quot;</span>);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <a class="code" href="a07305.html#a07313">PeakBackground</a> pb;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      pb.<a class="code" href="a07305.html#ae517bffd82b9428b4f1d9500ea01c04f">area</a> = area;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      pb.<a class="code" href="a07305.html#a89f6abd564014faeff7cd20c340a9c7d">height</a> = height;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">return</span> pb;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> PeakContainerConstIteratorT&gt;</div>
<div class="line"><a name="l00744"></a><span class="lineno"><a class="line" href="a07305.html#a98842b0ea91a8cbad79ce8a591c8125e">  744</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="a07305.html#a98842b0ea91a8cbad79ce8a591c8125e">simpson_</a>(PeakContainerConstIteratorT it_begin, PeakContainerConstIteratorT it_end)<span class="keyword"> const</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <span class="keywordtype">double</span> integral = 0.0;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = it_begin + 1; it &lt; it_end - 1; it = it + 2) <span class="comment">//OMS_CODING_TEST_EXCLUDE</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="a05830.html#aa6e8e201edf24007dc075bfef6e8210c">h</a> = it-&gt;getPos() - (it - 1)-&gt;getPos();</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="a05830.html#a93a8dc068053ec44ee7e45864ef969f7">k</a> = (it + 1)-&gt;getPos() - it-&gt;getPos();</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> y_h = (it - 1)-&gt;getIntensity();</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> y_0 = it-&gt;getIntensity();</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> y_k = (it + 1)-&gt;getIntensity();</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        integral += (1.0 / 6.0) * (<a class="code" href="a05830.html#aa6e8e201edf24007dc075bfef6e8210c">h</a> + <a class="code" href="a05830.html#a93a8dc068053ec44ee7e45864ef969f7">k</a>) * ((2.0 - <a class="code" href="a05830.html#a93a8dc068053ec44ee7e45864ef969f7">k</a> / <a class="code" href="a05830.html#aa6e8e201edf24007dc075bfef6e8210c">h</a>) * y_h + (pow(<a class="code" href="a05830.html#aa6e8e201edf24007dc075bfef6e8210c">h</a> + <a class="code" href="a05830.html#a93a8dc068053ec44ee7e45864ef969f7">k</a>, 2) / (<a class="code" href="a05830.html#aa6e8e201edf24007dc075bfef6e8210c">h</a> * <a class="code" href="a05830.html#a93a8dc068053ec44ee7e45864ef969f7">k</a>)) * y_0 + (2.0 - <a class="code" href="a05830.html#aa6e8e201edf24007dc075bfef6e8210c">h</a> / <a class="code" href="a05830.html#a93a8dc068053ec44ee7e45864ef969f7">k</a>) * y_k);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">return</span> integral;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> PeakContainerT&gt;</div>
<div class="line"><a name="l00761"></a><span class="lineno"><a class="line" href="a07305.html#aa1bd30f3d8f2caa4236e636e9d559c1f">  761</a></span>&#160;    <a class="code" href="a07305.html#a07317">PeakShapeMetrics</a> <a class="code" href="a07305.html#aa1bd30f3d8f2caa4236e636e9d559c1f">calculatePeakShapeMetrics_</a>(</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keyword">const</span> PeakContainerT&amp; pc, <span class="keywordtype">double</span> left, <span class="keywordtype">double</span> right,</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_height, <span class="keyword">const</span> <span class="keywordtype">double</span> peak_apex_pos</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    )<span class="keyword"> const</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <a class="code" href="a07305.html#a07317">PeakShapeMetrics</a> psm;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keywordflow">if</span> (pc.empty()) <span class="keywordflow">return</span> psm; <span class="comment">// return all &#39;0&#39;</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="comment">// enforce order: left &lt;= peakapex &lt;= right</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keywordflow">if</span> (!(left &lt;= peak_apex_pos &amp;&amp; peak_apex_pos &lt;= right)) <span class="keywordflow">throw</span> <a class="code" href="a08301.html">Exception::InvalidRange</a>(__FILE__, __LINE__, OPENMS_PRETTY_FUNCTION);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      PeakContainerT emg_pc;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <span class="keyword">const</span> PeakContainerT&amp; p = EMGPreProcess_(pc, emg_pc, left, right);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keyword">typename</span> PeakContainerT::ConstIterator it_PosBegin_l = p.PosBegin(left);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <span class="keyword">typename</span> PeakContainerT::ConstIterator it_PosEnd_apex = p.PosBegin(peak_apex_pos); <span class="comment">// if peak_apex_pos is correct, this will get the underlying iterator</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keyword">typename</span> PeakContainerT::ConstIterator it_PosEnd_r = p.PosEnd(right); <span class="comment">// past the end. Do not dereference (might be the true .end())</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = it_PosBegin_l; it != it_PosEnd_r; ++it) <span class="comment">//OMS_CODING_TEST_EXCLUDE</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="comment">// points across the peak</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        ++(psm.<a class="code" href="a07305.html#a33e3ab344e2804f18438c35febb31db7">points_across_baseline</a>);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">if</span> (it-&gt;getIntensity() &gt;= 0.5 * peak_height)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;          ++(psm.<a class="code" href="a07305.html#a0d5751d37650f192bd79e44932c91d03">points_across_half_height</a>);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="comment">// positions at peak heights</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      psm.<a class="code" href="a07305.html#ae50a4652a3096c4aafb4c7968cc05570">start_position_at_5</a> = findPosAtPeakHeightPercent_(it_PosBegin_l, it_PosEnd_apex, p.end(), peak_height, 0.05, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      psm.<a class="code" href="a07305.html#ad92548804cdc1dc8daa541c8eb7bd32c">start_position_at_10</a> = findPosAtPeakHeightPercent_(it_PosBegin_l, it_PosEnd_apex, p.end(), peak_height, 0.1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      psm.<a class="code" href="a07305.html#ac1626b7e3cd395bf0656f5991cb3c766">start_position_at_50</a> = findPosAtPeakHeightPercent_(it_PosBegin_l, it_PosEnd_apex, p.end(), peak_height, 0.5, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      psm.<a class="code" href="a07305.html#ab5bb698c85176875aa7b7f7bb8f31b46">end_position_at_5</a> = findPosAtPeakHeightPercent_(it_PosEnd_apex, it_PosEnd_r, p.end(), peak_height, 0.05, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      psm.<a class="code" href="a07305.html#a97a165f1d5bc711086ea31504ae53771">end_position_at_10</a> = findPosAtPeakHeightPercent_(it_PosEnd_apex, it_PosEnd_r, p.end(), peak_height, 0.1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      psm.<a class="code" href="a07305.html#a46b734fc6d34bf148242321438f290cf">end_position_at_50</a> = findPosAtPeakHeightPercent_(it_PosEnd_apex, it_PosEnd_r, p.end(), peak_height, 0.5, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="comment">// peak widths</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      psm.<a class="code" href="a07305.html#a23409e6cc95e068709f109902662ea30">width_at_5</a> = psm.<a class="code" href="a07305.html#ab5bb698c85176875aa7b7f7bb8f31b46">end_position_at_5</a> - psm.<a class="code" href="a07305.html#ae50a4652a3096c4aafb4c7968cc05570">start_position_at_5</a>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      psm.<a class="code" href="a07305.html#aa9c006f7ff4376fe5ffe2be13f5a42c7">width_at_10</a> = psm.<a class="code" href="a07305.html#a97a165f1d5bc711086ea31504ae53771">end_position_at_10</a> - psm.<a class="code" href="a07305.html#ad92548804cdc1dc8daa541c8eb7bd32c">start_position_at_10</a>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      psm.<a class="code" href="a07305.html#a426386a9590347f1e400c67bd3b2f87f">width_at_50</a> = psm.<a class="code" href="a07305.html#a46b734fc6d34bf148242321438f290cf">end_position_at_50</a> - psm.<a class="code" href="a07305.html#ac1626b7e3cd395bf0656f5991cb3c766">start_position_at_50</a>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      psm.<a class="code" href="a07305.html#aaf61fefba7dbf239776d9050b500131a">total_width</a> = (p.PosEnd(right) - 1)-&gt;getPos() - p.PosBegin(left)-&gt;getPos();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      psm.<a class="code" href="a07305.html#ac8f610062612cf55a9b927feaf40213f">slope_of_baseline</a> = (p.PosEnd(right) - 1)-&gt;getIntensity() - p.PosBegin(left)-&gt;getIntensity();</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      psm.<a class="code" href="a07305.html#a6804c3176237e7617d845954a06e2b5d">baseline_delta_2_height</a> = psm.<a class="code" href="a07305.html#ac8f610062612cf55a9b927feaf40213f">slope_of_baseline</a> / peak_height;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="comment">// Source of tailing_factor and asymmetry_factor formulas:</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="comment">// USP 40 - NF 35 The United States Pharmacopeia and National Formulary - Supplementary</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      psm.<a class="code" href="a07305.html#ac664f477fa38532b6519c103d9eeb942">tailing_factor</a> = psm.<a class="code" href="a07305.html#a23409e6cc95e068709f109902662ea30">width_at_5</a> / (2*(peak_apex_pos - psm.<a class="code" href="a07305.html#ae50a4652a3096c4aafb4c7968cc05570">start_position_at_5</a>));</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      psm.<a class="code" href="a07305.html#adfbbcf8d0ce1dc07d8af1f07919eea0c">asymmetry_factor</a> = (psm.<a class="code" href="a07305.html#a97a165f1d5bc711086ea31504ae53771">end_position_at_10</a> - peak_apex_pos) / (peak_apex_pos - psm.<a class="code" href="a07305.html#ad92548804cdc1dc8daa541c8eb7bd32c">start_position_at_10</a>);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keywordflow">return</span> psm;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> PeakContainerConstIteratorT&gt;</div>
<div class="line"><a name="l00832"></a><span class="lineno"><a class="line" href="a07305.html#a65bd9bbd040624427bec220b3a3e51a9">  832</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="a07305.html#a65bd9bbd040624427bec220b3a3e51a9">findPosAtPeakHeightPercent_</a>(</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      PeakContainerConstIteratorT it_left,  <span class="comment">// must not be past the end</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      PeakContainerConstIteratorT it_right, <span class="comment">// might be past the end</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      PeakContainerConstIteratorT it_end,   <span class="comment">// definitely past-the-end</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> peak_height,</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> percent,</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> is_left_half)<span class="keyword"> const</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="comment">// no points in range</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <span class="keywordflow">if</span> (it_left == it_end) <span class="keywordflow">throw</span> <a class="code" href="a08301.html">Exception::InvalidRange</a>(__FILE__, __LINE__, OPENMS_PRETTY_FUNCTION);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <span class="comment">// only one point in range</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">if</span> (it_left == it_right) <span class="keywordflow">return</span> it_left-&gt;getPos();</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> percent_intensity = peak_height * percent;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      PeakContainerConstIteratorT closest;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">if</span> (is_left_half)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        closest = it_left;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">for</span> (</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;          PeakContainerConstIteratorT it = it_left;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;          it &lt; it_right &amp;&amp; it-&gt;getIntensity() &lt;= percent_intensity;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;          closest = it++</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        ) {}</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keywordflow">else</span> <span class="comment">// right half; search from right to left</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        closest = it_right - 1; <span class="comment">// make sure we can deference it</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">for</span> (</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          PeakContainerConstIteratorT it = it_right - 1;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;          it &gt;= it_left &amp;&amp; it-&gt;getIntensity() &lt;= percent_intensity;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          closest = it--</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        ) {}</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">return</span> closest-&gt;getPos();</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno"><a class="line" href="a07305.html#a3d268136847e7e1e83c2cb2a2b773a47">  879</a></span>&#160;    <a class="code" href="a08769.html">String</a> integration_type_ = INTEGRATION_TYPE_INTENSITYSUM;</div>
<div class="line"><a name="l00884"></a><span class="lineno"><a class="line" href="a07305.html#a0dd230f7b66ba15c6a5dde106f67344a">  884</a></span>&#160;    <a class="code" href="a08769.html">String</a> baseline_type_ = BASELINE_TYPE_BASETOBASE;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno"><a class="line" href="a07305.html#a0e545c99d3fbd97887715fec5f36d316">  888</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="a07305.html#a0e545c99d3fbd97887715fec5f36d316">fit_EMG_</a>;</div>
<div class="line"><a name="l00889"></a><span class="lineno"><a class="line" href="a07305.html#a847db31d38426cde29072daf64fb8370">  889</a></span>&#160;    <a class="code" href="a10233.html">EmgGradientDescent</a> <a class="code" href="a07305.html#a847db31d38426cde29072daf64fb8370">emg_</a>;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> PeakContainerT&gt;</div>
<div class="line"><a name="l00906"></a><span class="lineno"><a class="line" href="a07305.html#ad0aa0a107dcaacc16ab505b5277c57c9">  906</a></span>&#160;    <span class="keyword">const</span> PeakContainerT&amp; <a class="code" href="a07305.html#ad0aa0a107dcaacc16ab505b5277c57c9">EMGPreProcess_</a>(</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keyword">const</span> PeakContainerT&amp; pc,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      PeakContainerT&amp; emg_pc,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <span class="keywordtype">double</span>&amp; left,</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordtype">double</span>&amp; right</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    )<span class="keyword"> const</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">if</span> (fit_EMG_)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        emg_.<a class="code" href="a10233.html#a42d48429694e9de32ad1fc3ca776f171">fitEMGPeakModel</a>(pc, emg_pc, left, right);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        left = emg_pc.front().getPos();</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        right = emg_pc.back().getPos();</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="keywordflow">return</span> emg_pc;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">return</span> pc;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  };</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aa04223_html"><div class="ttname"><a href="a04223.html">MSChromatogram.h</a></div></div>
<div class="ttc" id="aa07305_html_ad92548804cdc1dc8daa541c8eb7bd32c"><div class="ttname"><a href="a07305.html#ad92548804cdc1dc8daa541c8eb7bd32c">OpenMS::PeakIntegrator::PeakShapeMetrics::start_position_at_10</a></div><div class="ttdeci">double start_position_at_10</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:149</div></div>
<div class="ttc" id="aa08317_html"><div class="ttname"><a href="a08317.html">OpenMS::Exception::InvalidParameter</a></div><div class="ttdoc">Exception indicating that an invalid parameter was handed over to an algorithm.</div><div class="ttdef"><b>Definition:</b> Exception.h:347</div></div>
<div class="ttc" id="aa05830_html_a93a8dc068053ec44ee7e45864ef969f7"><div class="ttname"><a href="a05830.html#a93a8dc068053ec44ee7e45864ef969f7">OpenMS::Constants::k</a></div><div class="ttdeci">const double k</div></div>
<div class="ttc" id="aa07305_html_a426386a9590347f1e400c67bd3b2f87f"><div class="ttname"><a href="a07305.html#a426386a9590347f1e400c67bd3b2f87f">OpenMS::PeakIntegrator::PeakShapeMetrics::width_at_50</a></div><div class="ttdeci">double width_at_50</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:141</div></div>
<div class="ttc" id="aa08745_html"><div class="ttname"><a href="a08745.html">OpenMS::Param</a></div><div class="ttdoc">Management and storage of parameters / INI files.</div><div class="ttdef"><b>Definition:</b> Param.h:73</div></div>
<div class="ttc" id="aa05816_html_ga45a74ea28109e7e1ed992fbd2ee97778"><div class="ttname"><a href="a05816.html#ga45a74ea28109e7e1ed992fbd2ee97778">OPENMS_PRECONDITION</a></div><div class="ttdeci">#define OPENMS_PRECONDITION(condition, message)</div><div class="ttdoc">Precondition macro.</div><div class="ttdef"><b>Definition:</b> openms/include/OpenMS/CONCEPT/Macros.h:136</div></div>
<div class="ttc" id="aa07305_html_ae517bffd82b9428b4f1d9500ea01c04f"><div class="ttname"><a href="a07305.html#ae517bffd82b9428b4f1d9500ea01c04f">OpenMS::PeakIntegrator::PeakArea::area</a></div><div class="ttdeci">double area</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:90</div></div>
<div class="ttc" id="aa08549_html_abdcce0f11b8d73a2b4da5b1a00457d7b"><div class="ttname"><a href="a08549.html#abdcce0f11b8d73a2b4da5b1a00457d7b">OpenMS::ConvexHull2D::PointArrayType</a></div><div class="ttdeci">std::vector&lt; PointType &gt; PointArrayType</div><div class="ttdef"><b>Definition:</b> ConvexHull2D.h:76</div></div>
<div class="ttc" id="aa10097_html"><div class="ttname"><a href="a10097.html">OpenMS::MSSpectrum</a></div><div class="ttdoc">The representation of a 1D spectrum.</div><div class="ttdef"><b>Definition:</b> MSSpectrum.h:67</div></div>
<div class="ttc" id="aa07305_html"><div class="ttname"><a href="a07305.html">OpenMS::PeakIntegrator</a></div><div class="ttdoc">Compute the area, background and shape metrics of a peak.</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:72</div></div>
<div class="ttc" id="aa07305_html_adfbbcf8d0ce1dc07d8af1f07919eea0c"><div class="ttname"><a href="a07305.html#adfbbcf8d0ce1dc07d8af1f07919eea0c">OpenMS::PeakIntegrator::PeakShapeMetrics::asymmetry_factor</a></div><div class="ttdeci">double asymmetry_factor</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:193</div></div>
<div class="ttc" id="aa03566_html"><div class="ttname"><a href="a03566.html">ConvexHull2D.h</a></div></div>
<div class="ttc" id="aa07305_html_a23409e6cc95e068709f109902662ea30"><div class="ttname"><a href="a07305.html#a23409e6cc95e068709f109902662ea30">OpenMS::PeakIntegrator::PeakShapeMetrics::width_at_5</a></div><div class="ttdeci">double width_at_5</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:133</div></div>
<div class="ttc" id="aa07305_html_a65bd9bbd040624427bec220b3a3e51a9"><div class="ttname"><a href="a07305.html#a65bd9bbd040624427bec220b3a3e51a9">OpenMS::PeakIntegrator::findPosAtPeakHeightPercent_</a></div><div class="ttdeci">double findPosAtPeakHeightPercent_(PeakContainerConstIteratorT it_left, PeakContainerConstIteratorT it_right, PeakContainerConstIteratorT it_end, const double peak_height, const double percent, const bool is_left_half) const</div><div class="ttdoc">Find the position (RT/MZ) at a given percentage of peak's height.</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:832</div></div>
<div class="ttc" id="aa07305_html_ac8f610062612cf55a9b927feaf40213f"><div class="ttname"><a href="a07305.html#ac8f610062612cf55a9b927feaf40213f">OpenMS::PeakIntegrator::PeakShapeMetrics::slope_of_baseline</a></div><div class="ttdeci">double slope_of_baseline</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:198</div></div>
<div class="ttc" id="aa04229_html"><div class="ttname"><a href="a04229.html">MSSpectrum.h</a></div></div>
<div class="ttc" id="aa07305_html_a0e545c99d3fbd97887715fec5f36d316"><div class="ttname"><a href="a07305.html#a0e545c99d3fbd97887715fec5f36d316">OpenMS::PeakIntegrator::fit_EMG_</a></div><div class="ttdeci">bool fit_EMG_</div><div class="ttdoc">Enable/disable EMG peak model fitting.</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:888</div></div>
<div class="ttc" id="aa05830_html_aa6e8e201edf24007dc075bfef6e8210c"><div class="ttname"><a href="a05830.html#aa6e8e201edf24007dc075bfef6e8210c">OpenMS::Constants::h</a></div><div class="ttdeci">const double h</div></div>
<div class="ttc" id="aa07305_html_ae50a4652a3096c4aafb4c7968cc05570"><div class="ttname"><a href="a07305.html#ae50a4652a3096c4aafb4c7968cc05570">OpenMS::PeakIntegrator::PeakShapeMetrics::start_position_at_5</a></div><div class="ttdeci">double start_position_at_5</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:145</div></div>
<div class="ttc" id="aa07305_html_aeea403d8136cb2ccbd862d15ba2b9c83"><div class="ttname"><a href="a07305.html#aeea403d8136cb2ccbd862d15ba2b9c83">OpenMS::PeakIntegrator::integratePeak_</a></div><div class="ttdeci">PeakArea integratePeak_(const PeakContainerT &amp;pc, double left, double right) const</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:543</div></div>
<div class="ttc" id="aa00001_html_a12109"><div class="ttname"><a href="a00001.html#a12109">double</a></div></div>
<div class="ttc" id="aa10073_html"><div class="ttname"><a href="a10073.html">OpenMS::MSChromatogram</a></div><div class="ttdoc">The representation of a chromatogram.</div><div class="ttdef"><b>Definition:</b> MSChromatogram.h:54</div></div>
<div class="ttc" id="aa07305_html_a1ac98462432789437fe4e0bf9520fd82"><div class="ttname"><a href="a07305.html#a1ac98462432789437fe4e0bf9520fd82">OpenMS::PeakIntegrator::PeakArea::hull_points</a></div><div class="ttdeci">ConvexHull2D::PointArrayType hull_points</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:102</div></div>
<div class="ttc" id="aa00001_html_a12329"><div class="ttname"><a href="a00001.html#a12329">int</a></div></div>
<div class="ttc" id="aa08589_html"><div class="ttname"><a href="a08589.html">OpenMS::DefaultParamHandler</a></div><div class="ttdoc">A base class for all classes handling default parameters.</div><div class="ttdef"><b>Definition:</b> DefaultParamHandler.h:91</div></div>
<div class="ttc" id="aa07305_html_a89f6abd564014faeff7cd20c340a9c7d"><div class="ttname"><a href="a07305.html#a89f6abd564014faeff7cd20c340a9c7d">OpenMS::PeakIntegrator::PeakArea::height</a></div><div class="ttdeci">double height</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:94</div></div>
<div class="ttc" id="aa07305_html_ab5bb698c85176875aa7b7f7bb8f31b46"><div class="ttname"><a href="a07305.html#ab5bb698c85176875aa7b7f7bb8f31b46">OpenMS::PeakIntegrator::PeakShapeMetrics::end_position_at_5</a></div><div class="ttdeci">double end_position_at_5</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:157</div></div>
<div class="ttc" id="aa07305_html_a847db31d38426cde29072daf64fb8370"><div class="ttname"><a href="a07305.html#a847db31d38426cde29072daf64fb8370">OpenMS::PeakIntegrator::emg_</a></div><div class="ttdeci">EmgGradientDescent emg_</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:889</div></div>
<div class="ttc" id="aa07305_html_a0d5751d37650f192bd79e44932c91d03"><div class="ttname"><a href="a07305.html#a0d5751d37650f192bd79e44932c91d03">OpenMS::PeakIntegrator::PeakShapeMetrics::points_across_half_height</a></div><div class="ttdeci">Int points_across_half_height</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:211</div></div>
<div class="ttc" id="aa07305_html_a97a165f1d5bc711086ea31504ae53771"><div class="ttname"><a href="a07305.html#a97a165f1d5bc711086ea31504ae53771">OpenMS::PeakIntegrator::PeakShapeMetrics::end_position_at_10</a></div><div class="ttdeci">double end_position_at_10</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:161</div></div>
<div class="ttc" id="aa07305_html_a6804c3176237e7617d845954a06e2b5d"><div class="ttname"><a href="a07305.html#a6804c3176237e7617d845954a06e2b5d">OpenMS::PeakIntegrator::PeakShapeMetrics::baseline_delta_2_height</a></div><div class="ttdeci">double baseline_delta_2_height</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:203</div></div>
<div class="ttc" id="aa07305_html_aaf61fefba7dbf239776d9050b500131a"><div class="ttname"><a href="a07305.html#aaf61fefba7dbf239776d9050b500131a">OpenMS::PeakIntegrator::PeakShapeMetrics::total_width</a></div><div class="ttdeci">double total_width</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:169</div></div>
<div class="ttc" id="aa08769_html"><div class="ttname"><a href="a08769.html">OpenMS::String</a></div><div class="ttdoc">A more convenient string class.</div><div class="ttdef"><b>Definition:</b> String.h:58</div></div>
<div class="ttc" id="aa07305_html_ac664f477fa38532b6519c103d9eeb942"><div class="ttname"><a href="a07305.html#ac664f477fa38532b6519c103d9eeb942">OpenMS::PeakIntegrator::PeakShapeMetrics::tailing_factor</a></div><div class="ttdeci">double tailing_factor</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:183</div></div>
<div class="ttc" id="aa07305_html_a46b734fc6d34bf148242321438f290cf"><div class="ttname"><a href="a07305.html#a46b734fc6d34bf148242321438f290cf">OpenMS::PeakIntegrator::PeakShapeMetrics::end_position_at_50</a></div><div class="ttdeci">double end_position_at_50</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:165</div></div>
<div class="ttc" id="aa07305_html_a33e3ab344e2804f18438c35febb31db7"><div class="ttname"><a href="a07305.html#a33e3ab344e2804f18438c35febb31db7">OpenMS::PeakIntegrator::PeakShapeMetrics::points_across_baseline</a></div><div class="ttdeci">Int points_across_baseline</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:207</div></div>
<div class="ttc" id="aa10233_html_a42d48429694e9de32ad1fc3ca776f171"><div class="ttname"><a href="a10233.html#a42d48429694e9de32ad1fc3ca776f171">OpenMS::EmgGradientDescent::fitEMGPeakModel</a></div><div class="ttdeci">void fitEMGPeakModel(const PeakContainerT &amp;input_peak, PeakContainerT &amp;output_peak, const double left_pos=0.0, const double right_pos=0.0) const</div><div class="ttdoc">Fit the given peak (either MSChromatogram or MSSpectrum) to the EMG peak model.</div></div>
<div class="ttc" id="aa03512_html_a0649d2eea8e784aa7af65942f27a6174"><div class="ttname"><a href="a03512.html#a0649d2eea8e784aa7af65942f27a6174">OPENMS_LOG_WARN</a></div><div class="ttdeci">#define OPENMS_LOG_WARN</div><div class="ttdoc">Macro if a warning, a piece of information which should be read by the user, should be logged.</div><div class="ttdef"><b>Definition:</b> LogStream.h:460</div></div>
<div class="ttc" id="aa07305_html_a07313"><div class="ttname"><a href="a07305.html#a07313">OpenMS::PeakIntegrator::PeakBackground</a></div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:110</div></div>
<div class="ttc" id="aa07305_html_a07317"><div class="ttname"><a href="a07305.html#a07317">OpenMS::PeakIntegrator::PeakShapeMetrics</a></div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:128</div></div>
<div class="ttc" id="aa03512_html"><div class="ttname"><a href="a03512.html">LogStream.h</a></div></div>
<div class="ttc" id="aa05782_html_gaba0996d26f7be2572973245b51852757"><div class="ttname"><a href="a05782.html#gaba0996d26f7be2572973245b51852757">OpenMS::UInt</a></div><div class="ttdeci">unsigned int UInt</div><div class="ttdoc">Unsigned integer type.</div><div class="ttdef"><b>Definition:</b> Types.h:94</div></div>
<div class="ttc" id="aa07305_html_a07309"><div class="ttname"><a href="a07305.html#a07309">OpenMS::PeakIntegrator::PeakArea</a></div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:85</div></div>
<div class="ttc" id="aa07305_html_a1d398adbb7b8be081b5efc3cd59f3c3e"><div class="ttname"><a href="a07305.html#a1d398adbb7b8be081b5efc3cd59f3c3e">OpenMS::PeakIntegrator::estimateBackground_</a></div><div class="ttdeci">PeakBackground estimateBackground_(const PeakContainerT &amp;pc, double left, double right, const double peak_apex_pos) const</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:647</div></div>
<div class="ttc" id="aa07305_html_ad0aa0a107dcaacc16ab505b5277c57c9"><div class="ttname"><a href="a07305.html#ad0aa0a107dcaacc16ab505b5277c57c9">OpenMS::PeakIntegrator::EMGPreProcess_</a></div><div class="ttdeci">const PeakContainerT &amp; EMGPreProcess_(const PeakContainerT &amp;pc, PeakContainerT &amp;emg_pc, double &amp;left, double &amp;right) const</div><div class="ttdoc">Fit the peak to the EMG model.</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:906</div></div>
<div class="ttc" id="aa07305_html_ac1626b7e3cd395bf0656f5991cb3c766"><div class="ttname"><a href="a07305.html#ac1626b7e3cd395bf0656f5991cb3c766">OpenMS::PeakIntegrator::PeakShapeMetrics::start_position_at_50</a></div><div class="ttdeci">double start_position_at_50</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:153</div></div>
<div class="ttc" id="aa07305_html_a109d04f17ed8a29581da1da877cd8a91"><div class="ttname"><a href="a07305.html#a109d04f17ed8a29581da1da877cd8a91">OpenMS::PeakIntegrator::PeakArea::apex_pos</a></div><div class="ttdeci">double apex_pos</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:98</div></div>
<div class="ttc" id="aa10073_html_a4895afe86c2aa0747ae0411c58c82114"><div class="ttname"><a href="a10073.html#a4895afe86c2aa0747ae0411c58c82114">OpenMS::MSChromatogram::ConstIterator</a></div><div class="ttdeci">ContainerType::const_iterator ConstIterator</div><div class="ttdoc">Non-mutable iterator.</div><div class="ttdef"><b>Definition:</b> MSChromatogram.h:93</div></div>
<div class="ttc" id="aa08301_html"><div class="ttname"><a href="a08301.html">OpenMS::Exception::InvalidRange</a></div><div class="ttdoc">Invalid range exception.</div><div class="ttdef"><b>Definition:</b> Exception.h:285</div></div>
<div class="ttc" id="aa07305_html_aa1bd30f3d8f2caa4236e636e9d559c1f"><div class="ttname"><a href="a07305.html#aa1bd30f3d8f2caa4236e636e9d559c1f">OpenMS::PeakIntegrator::calculatePeakShapeMetrics_</a></div><div class="ttdeci">PeakShapeMetrics calculatePeakShapeMetrics_(const PeakContainerT &amp;pc, double left, double right, const double peak_height, const double peak_apex_pos) const</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:761</div></div>
<div class="ttc" id="aa03650_html"><div class="ttname"><a href="a03650.html">String.h</a></div></div>
<div class="ttc" id="aa08601_html"><div class="ttname"><a href="a08601.html">OpenMS::DPosition&lt; 2 &gt;</a></div></div>
<div class="ttc" id="aa03593_html"><div class="ttname"><a href="a03593.html">DefaultParamHandler.h</a></div></div>
<div class="ttc" id="aa10233_html"><div class="ttname"><a href="a10233.html">OpenMS::EmgGradientDescent</a></div><div class="ttdoc">Compute the area, background and shape metrics of a peak.</div><div class="ttdef"><b>Definition:</b> EmgGradientDescent.h:64</div></div>
<div class="ttc" id="aa07305_html_aa9c006f7ff4376fe5ffe2be13f5a42c7"><div class="ttname"><a href="a07305.html#aa9c006f7ff4376fe5ffe2be13f5a42c7">OpenMS::PeakIntegrator::PeakShapeMetrics::width_at_10</a></div><div class="ttdeci">double width_at_10</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:137</div></div>
<div class="ttc" id="aa07305_html_a98842b0ea91a8cbad79ce8a591c8125e"><div class="ttname"><a href="a07305.html#a98842b0ea91a8cbad79ce8a591c8125e">OpenMS::PeakIntegrator::simpson_</a></div><div class="ttdeci">double simpson_(PeakContainerConstIteratorT it_begin, PeakContainerConstIteratorT it_end) const</div><div class="ttdoc">Simpson's rule algorithm.</div><div class="ttdef"><b>Definition:</b> PeakIntegrator.h:744</div></div>
<div class="ttc" id="aa10097_html_a4895afe86c2aa0747ae0411c58c82114"><div class="ttname"><a href="a10097.html#a4895afe86c2aa0747ae0411c58c82114">OpenMS::MSSpectrum::ConstIterator</a></div><div class="ttdeci">ContainerType::const_iterator ConstIterator</div><div class="ttdoc">Non-mutable iterator.</div><div class="ttdef"><b>Definition:</b> MSSpectrum.h:104</div></div>
<div class="ttc" id="aa04271_html"><div class="ttname"><a href="a04271.html">EmgGradientDescent.h</a></div></div>
<div class="ttc" id="aa05822_html"><div class="ttname"><a href="a05822.html">OpenMS</a></div><div class="ttdoc">Main OpenMS namespace.</div><div class="ttdef"><b>Definition:</b> FeatureDeconvolution.h:46</div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 9 2019 15:06:08 for OpenMS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
