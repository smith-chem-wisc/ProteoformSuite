<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenMS: GridBasedClustering.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style_ini.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="OpenMS_75x55_transparent.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenMS
   &#160;<span id="projectnumber">2.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9d1205d0e20af6628fc63aa9a15c8e1b.html">OpenMS</a></li><li class="navelem"><a class="el" href="dir_c5a4eb1f7f1e4ebb9b2ddcf6b8131a2c.html">COMPARISON</a></li><li class="navelem"><a class="el" href="dir_4d68d3ce27013456368e0ea0bf2cccf6.html">CLUSTERING</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">GridBasedClustering.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a03431.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//                   OpenMS -- Open-Source Mass Spectrometry</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Copyright The OpenMS Team -- Eberhard Karls University Tuebingen,</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// ETH Zurich, and Freie Universitaet Berlin 2002-2018.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// This software is released under a three-clause BSD license:</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//  * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//    notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//  * Redistributions in binary form must reproduce the above copyright</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//    notice, this list of conditions and the following disclaimer in the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//    documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//  * Neither the name of any author or any participating institution</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//    may be used to endorse or promote products derived from this software</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//    without specific prior written permission.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// For a full list of authors, refer to the file AUTHORS.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// ARE DISCLAIMED. IN NO EVENT SHALL ANY OF THE AUTHORS OR THE CONTRIBUTING</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// INSTITUTIONS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// $Maintainer: Lars Nilse $</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// $Authors: Lars Nilse, Johannes Veit $</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a04259.html">OpenMS/KERNEL/StandardTypes.h</a>&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a03605.html">OpenMS/DATASTRUCTURES/DRange.h</a>&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a03650.html">OpenMS/DATASTRUCTURES/String.h</a>&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a03521.html">OpenMS/CONCEPT/ProgressLogger.h</a>&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a03419.html">OpenMS/COMPARISON/CLUSTERING/ClusteringGrid.h</a>&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a03428.html">OpenMS/COMPARISON/CLUSTERING/GridBasedCluster.h</a>&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;queue&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;boost/unordered_map.hpp&gt;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">namespace </span><a class="code" href="a05822.html">OpenMS</a></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="a08189.html">   60</a></span>&#160;  <span class="keyword">class </span>OPENMS_DLLAPI <a class="code" href="a08189.html">MinimumDistance</a></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="a08189.html">MinimumDistance</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; cluster_index, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nearest_neighbour_index, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; distance);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">int</span> getClusterIndex() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">int</span> getNearestNeighbourIndex() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="a05822.html#a0f52d4afe25030292dc9f700abb34a20">operator&lt;</a>(<span class="keyword">const</span> <a class="code" href="a08189.html">MinimumDistance</a>&amp; other) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">bool</span> operator&gt;(<span class="keyword">const</span> <a class="code" href="a08189.html">MinimumDistance</a>&amp; other) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="a05835.html#a69356adacc066d0db0e0ec87c0da1c2c">operator==</a>(<span class="keyword">const</span> <a class="code" href="a08189.html">MinimumDistance</a>&amp; other) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="a08189.html">MinimumDistance</a>();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="a08189.html#ae24a71e258cf35ccf7e66a5bd079b2bd">   95</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="a08189.html#ae24a71e258cf35ccf7e66a5bd079b2bd">cluster_index_</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="a08189.html#a78425958789b6bba9b118e1dd8135f7d">  100</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="a08189.html#a78425958789b6bba9b118e1dd8135f7d">nearest_neighbour_index_</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="a08189.html#ad626c517ad932ce507e206046911b806">  105</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="a08189.html#ad626c517ad932ce507e206046911b806">distance_</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  };</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Metric&gt;</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="a08193.html">  125</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a08193.html">GridBasedClustering</a> :</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">public</span> <a class="code" href="a08481.html">ProgressLogger</a></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="a08193.html#a8e9a85a0b07b50d2167de474edad2359">  132</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="a08601.html">GridBasedCluster::Point</a> <a class="code" href="a08193.html#a8e9a85a0b07b50d2167de474edad2359">Point</a>; <span class="comment">// DPosition&lt;2&gt;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="a08193.html#a7236c907144321148d78f708da14d74a">  133</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="a08585.html">GridBasedCluster::Rectangle</a> <a class="code" href="a08193.html#a7236c907144321148d78f708da14d74a">Rectangle</a>; <span class="comment">// DBoundingBox&lt;2&gt;</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">  134</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="a08173.html#aa229a5292c096089f510cff1d8d1d064">ClusteringGrid::CellIndex</a> <a class="code" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">CellIndex</a>; <span class="comment">// std::pair&lt;int,int&gt;</span></div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="a08193.html#abb18a014484c80b14f684ca816cfd3cb">  135</a></span>&#160;    <span class="keyword">typedef</span> std::multiset&lt;MinimumDistance&gt;::const_iterator <a class="code" href="a08193.html#abb18a014484c80b14f684ca816cfd3cb">MultisetIterator</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="a08193.html#a60f3132df3f96e0b313d66c73c2a352b">  136</a></span>&#160;    <span class="keyword">typedef</span> boost::unordered::unordered_multimap&lt;int, MultisetIterator&gt;::const_iterator <a class="code" href="a08193.html#a60f3132df3f96e0b313d66c73c2a352b">NNIterator</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="a08193.html#a7f20c535c41ab740421ffa604372b6ae">  148</a></span>&#160;    <a class="code" href="a08193.html#a7f20c535c41ab740421ffa604372b6ae">GridBasedClustering</a>(Metric metric, <span class="keyword">const</span> std::vector&lt;double&gt;&amp; data_x,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        <span class="keyword">const</span> std::vector&lt;double&gt;&amp; data_y, <span class="keyword">const</span> std::vector&lt;int&gt;&amp; properties_A,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                        <span class="keyword">const</span> std::vector&lt;int&gt;&amp; properties_B, std::vector&lt;double&gt; grid_spacing_x,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                        std::vector&lt;double&gt; grid_spacing_y) :</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <a class="code" href="a08193.html#a5875dbbf48510a2396ad20046746221a">metric_</a>(metric),</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>(grid_spacing_x, grid_spacing_y)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <a class="code" href="a08193.html#a41f2c8be039fc59b05b033fd3e89583b">init_</a>(data_x, data_y, properties_A, properties_B);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="a08193.html#a5e59fdae97df627825d720215c4bfbba">  166</a></span>&#160;    <a class="code" href="a08193.html#a5e59fdae97df627825d720215c4bfbba">GridBasedClustering</a>(Metric metric, <span class="keyword">const</span> std::vector&lt;double&gt;&amp; data_x,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                        <span class="keyword">const</span> std::vector&lt;double&gt;&amp; data_y, std::vector&lt;double&gt; grid_spacing_x,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                        std::vector&lt;double&gt; grid_spacing_y) :</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="a08193.html#a5875dbbf48510a2396ad20046746221a">metric_</a>(metric),</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>(grid_spacing_x, grid_spacing_y)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="comment">// set properties A and B to -1, i.e. ignore properties when clustering</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      std::vector&lt;int&gt; properties_A(data_x.size(), -1);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      std::vector&lt;int&gt; properties_B(data_x.size(), -1);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="a08193.html#a41f2c8be039fc59b05b033fd3e89583b">init_</a>(data_x, data_y, properties_A, properties_B);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">  182</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a>()</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="comment">// progress logger</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="comment">// NOTE: for some reason, gcc7 chokes if we remove the OpenMS::String</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="comment">// below, so lets just not change it.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">Size</a> clusters_start = <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.size();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="a08481.html#a6ca049c9417a2a648b4d41aec766d56b">startProgress</a>(0, clusters_start, <a class="code" href="a08769.html">OpenMS::String</a>(<span class="stringliteral">&quot;clustering&quot;</span>));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="a08189.html">MinimumDistance</a> zero_distance(-1, -1, 0);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">// combine clusters until all have been moved to the final list</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">while</span> (<a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.size() &gt; 0)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="a08481.html#a05d564f4a203341c9f1b1e6c8ec1068d">setProgress</a>(clusters_start - <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.size());</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="a08193.html#abb18a014484c80b14f684ca816cfd3cb">MultisetIterator</a> smallest_distance_it = <a class="code" href="a08193.html#a7858bbd7bec5afb065a6eb652d8bf1db">distances_</a>.lower_bound(zero_distance);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordtype">int</span> cluster_index1 = smallest_distance_it-&gt;getClusterIndex();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordtype">int</span> cluster_index2 = smallest_distance_it-&gt;getNearestNeighbourIndex();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="a08193.html#adf52b1cf6be20a08fc74a40e2f486e62">eraseMinDistance_</a>(smallest_distance_it);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">// update cluster list</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        std::map&lt;int, GridBasedCluster&gt;::iterator cluster1_it = <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.find(cluster_index1);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        std::map&lt;int, GridBasedCluster&gt;::iterator cluster2_it = <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.find(cluster_index2);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keyword">const</span> <a class="code" href="a08185.html">GridBasedCluster</a>&amp; cluster1 = cluster1_it-&gt;second;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keyword">const</span> <a class="code" href="a08185.html">GridBasedCluster</a>&amp; cluster2 = cluster2_it-&gt;second;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keyword">const</span> std::vector&lt;int&gt;&amp; points1 = cluster1.<a class="code" href="a08185.html#a522a3996eb8a004dbfe839107f3a2e89">getPoints</a>();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keyword">const</span> std::vector&lt;int&gt;&amp; points2 = cluster2.<a class="code" href="a08185.html#a522a3996eb8a004dbfe839107f3a2e89">getPoints</a>();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        std::vector&lt;int&gt; new_points;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        new_points.reserve(points1.size() + points2.size());</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        new_points.insert(new_points.end(), points1.begin(), points1.end());</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        new_points.insert(new_points.end(), points2.begin(), points2.end());</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordtype">double</span> new_x = (cluster1.<a class="code" href="a08185.html#a0c4342e729d0cb2a9692a103b92e7a32">getCentre</a>().<a class="code" href="a08601.html#aa83259652f0c977f7d2d246474f4afde">getX</a>() * points1.size() + cluster2.<a class="code" href="a08185.html#a0c4342e729d0cb2a9692a103b92e7a32">getCentre</a>().<a class="code" href="a08601.html#aa83259652f0c977f7d2d246474f4afde">getX</a>() * points2.size()) / (points1.size() + points2.size());</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordtype">double</span> new_y = (cluster1.<a class="code" href="a08185.html#a0c4342e729d0cb2a9692a103b92e7a32">getCentre</a>().<a class="code" href="a08601.html#a80ab217ffe70d98ca6480e04083e28f2">getY</a>() * points1.size() + cluster2.<a class="code" href="a08185.html#a0c4342e729d0cb2a9692a103b92e7a32">getCentre</a>().<a class="code" href="a08601.html#a80ab217ffe70d98ca6480e04083e28f2">getY</a>() * points2.size()) / (points1.size() + points2.size());</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="comment">// update grid</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">CellIndex</a> cell_for_cluster1 = <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>(cluster1.<a class="code" href="a08185.html#a0c4342e729d0cb2a9692a103b92e7a32">getCentre</a>());</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">CellIndex</a> cell_for_cluster2 = <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>(cluster2.<a class="code" href="a08185.html#a0c4342e729d0cb2a9692a103b92e7a32">getCentre</a>());</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">CellIndex</a> cell_for_new_cluster = <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>(<a class="code" href="a08601.html">DPosition&lt;2&gt;</a>(new_x, new_y));</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a74e559158140500a4ecae778e2195975">removeCluster</a>(cell_for_cluster1, cluster_index1);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a74e559158140500a4ecae778e2195975">removeCluster</a>(cell_for_cluster2, cluster_index2);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#ad0e46ab2050613d458b51dd5c6327baa">addCluster</a>(cell_for_new_cluster, cluster_index1);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">// merge clusters</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keyword">const</span> <a class="code" href="a08585.html">Rectangle</a>&amp; box1 = cluster1.<a class="code" href="a08185.html#aa2cc373c1f3f903c637fef88fa44984d">getBoundingBox</a>();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keyword">const</span> <a class="code" href="a08585.html">Rectangle</a>&amp; box2 = cluster2.<a class="code" href="a08185.html#aa2cc373c1f3f903c637fef88fa44984d">getBoundingBox</a>();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <a class="code" href="a08585.html">Rectangle</a> new_box(box1);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        new_box.<a class="code" href="a08585.html#af8aceaf27078e216608a86572079213a">enlarge</a>(box2.<a class="code" href="a08593.html#aff675c00c7f2dd6d38c5deefb4b4525e">minPosition</a>());</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        new_box.<a class="code" href="a08585.html#af8aceaf27078e216608a86572079213a">enlarge</a>(box2.<a class="code" href="a08593.html#a2bd69d0a4455fd82199e30ef42221625">maxPosition</a>());</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment">// Properties A of both clusters should by now be the same. The merge veto has been checked</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment">// when a new entry to the minimum distance list was added, @see findNearestNeighbour_.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> (cluster1.<a class="code" href="a08185.html#aaea75303b47c6f0f0f37f65116233680">getPropertyA</a>() != cluster2.<a class="code" href="a08185.html#aaea75303b47c6f0f0f37f65116233680">getPropertyA</a>())</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          <span class="keywordflow">throw</span> <a class="code" href="a08313.html">Exception::InvalidValue</a>(__FILE__, __LINE__, OPENMS_PRETTY_FUNCTION, <span class="stringliteral">&quot;Property A of both clusters not the same. &quot;</span>, <span class="stringliteral">&quot;A&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordtype">int</span> new_A = cluster1.<a class="code" href="a08185.html#aaea75303b47c6f0f0f37f65116233680">getPropertyA</a>();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keyword">const</span> std::vector&lt;int&gt;&amp; B1 = cluster1.<a class="code" href="a08185.html#a967a97ae2e29a2ebbbcca29b75018e22">getPropertiesB</a>();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keyword">const</span> std::vector&lt;int&gt;&amp; B2 = cluster2.<a class="code" href="a08185.html#a967a97ae2e29a2ebbbcca29b75018e22">getPropertiesB</a>();</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        std::vector&lt;int&gt; new_B;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        new_B.reserve(B1.size() + B2.size());</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        new_B.insert(new_B.end(), B1.begin(), B1.end());</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        new_B.insert(new_B.end(), B2.begin(), B2.end());</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="a08185.html">GridBasedCluster</a> new_cluster(<a class="code" href="a08601.html">DPosition&lt;2&gt;</a>(new_x, new_y), new_box, new_points, new_A, new_B);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.erase(cluster1_it);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.erase(cluster2_it);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.insert(std::make_pair(cluster_index1, new_cluster));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        std::set&lt;int&gt; clusters_to_be_updated;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        clusters_to_be_updated.insert(cluster_index1);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">// erase distance object of cluster with cluster_index2 without updating (does not exist anymore!)</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">// (the one with cluster_index1 has already been erased at the top of the while loop)</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="a08193.html#adf52b1cf6be20a08fc74a40e2f486e62">eraseMinDistance_</a>(<a class="code" href="a08193.html#acfe2edce5b65c5c73e44cd7476105b8a">distance_it_for_cluster_idx_</a>[cluster_index2]);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">// find out which clusters need to be updated</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        std::pair&lt;NNIterator, NNIterator&gt; nn_range = <a class="code" href="a08193.html#a9cd8423f72cbb43d29404e377c25c0bc">reverse_nns_</a>.equal_range(cluster_index1);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="a08193.html#a60f3132df3f96e0b313d66c73c2a352b">NNIterator</a> nn_it = nn_range.first; nn_it != nn_range.second;)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          clusters_to_be_updated.insert(nn_it-&gt;second-&gt;getClusterIndex());</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          <a class="code" href="a08193.html#adf52b1cf6be20a08fc74a40e2f486e62">eraseMinDistance_</a>((nn_it++)-&gt;second);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        nn_range = <a class="code" href="a08193.html#a9cd8423f72cbb43d29404e377c25c0bc">reverse_nns_</a>.equal_range(cluster_index2);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="a08193.html#a60f3132df3f96e0b313d66c73c2a352b">NNIterator</a> nn_it = nn_range.first; nn_it != nn_range.second;)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          clusters_to_be_updated.insert(nn_it-&gt;second-&gt;getClusterIndex());</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          <a class="code" href="a08193.html#adf52b1cf6be20a08fc74a40e2f486e62">eraseMinDistance_</a>((nn_it++)-&gt;second);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">// update clusters</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">for</span> (std::set&lt;int&gt;::const_iterator cluster_index = clusters_to_be_updated.begin(); cluster_index != clusters_to_be_updated.end(); ++cluster_index)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          std::map&lt;int, GridBasedCluster&gt;::iterator c_it = <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.find(*cluster_index);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          <span class="keyword">const</span> <a class="code" href="a08185.html">GridBasedCluster</a>&amp; <a class="code" href="a05830.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = c_it-&gt;second;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="a08193.html#a1e03972a8a2312929b7660ab9d1b3adb">findNearestNeighbour_</a>(<a class="code" href="a05830.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>, *cluster_index))</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a74e559158140500a4ecae778e2195975">removeCluster</a>(<a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>(<a class="code" href="a05830.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>.getCentre()), *cluster_index);          <span class="comment">// remove from grid</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.erase(c_it);          <span class="comment">// remove from cluster list</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <a class="code" href="a08481.html#ab11bd2bba91e2c1055b2eeb376a25d0e">endProgress</a>();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="a08193.html#a48ceb9a01e80ee721ec44179c9b5c674">  296</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a08193.html#a48ceb9a01e80ee721ec44179c9b5c674">extendClustersY</a>()</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="comment">// construct new grid (grid only in x-direction, single cell in y-direction)</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      std::vector&lt;double&gt; grid_spacing_x = <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a05720f680a5c22092963f9e33e78c199">getGridSpacingX</a>();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      std::vector&lt;double&gt; grid_spacing_y = <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#aa45686cce9f5e30877fad4315027fcba">getGridSpacingY</a>();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      std::vector&lt;double&gt; grid_spacing_y_new;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      grid_spacing_y_new.push_back(grid_spacing_y.front());</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      grid_spacing_y_new.push_back(grid_spacing_y.back());</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <a class="code" href="a08173.html">ClusteringGrid</a> grid_x_only(grid_spacing_x, grid_spacing_y_new);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="comment">// register final clusters on the new grid</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">for</span> (std::map&lt;int, GridBasedCluster&gt;::const_iterator it = <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.begin(); it != <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.end(); ++it)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordtype">int</span> cluster_index = it-&gt;first;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <a class="code" href="a08185.html">GridBasedCluster</a> <a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a> = it-&gt;second;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        grid_x_only.<a class="code" href="a08173.html#ad0e46ab2050613d458b51dd5c6327baa">addCluster</a>(grid_x_only.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>(<a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a>.getCentre()), cluster_index);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">// scan through x on the grid</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> cell = 0; cell &lt; grid_spacing_x.size(); ++cell)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <a class="code" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">CellIndex</a> grid_index(cell, 1);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">if</span> (grid_x_only.<a class="code" href="a08173.html#acf78335e02d724c84dcff93dfa55c0d2">isNonEmptyCell</a>(grid_index))</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          std::list&lt;int&gt; cluster_indices = grid_x_only.<a class="code" href="a08173.html#a7e681ee130060cce3f596859c74e8437">getClusters</a>(grid_index);          <span class="comment">// indices of clusters in this x-range</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          <span class="keywordflow">if</span> (cluster_indices.size() &gt; 1)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="comment">// First, order the clusters in ascending y.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            std::list&lt;GridBasedCluster&gt; cluster_list;            <span class="comment">// list to order clusters in y</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            std::map&lt;GridBasedCluster, int&gt; index_list;           <span class="comment">// allows us to keep track of cluster indices after sorting</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">for</span> (std::list&lt;int&gt;::const_iterator it = cluster_indices.begin(); it != cluster_indices.end(); ++it)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;              cluster_list.push_back(<a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.find(*it)-&gt;second);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;              index_list.insert(std::make_pair(<a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.find(*it)-&gt;second, *it));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            cluster_list.sort();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="comment">// Now check if two adjacent clusters c1 and c2 can be merged.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            std::list&lt;GridBasedCluster&gt;::const_iterator c1 = cluster_list.begin();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            std::list&lt;GridBasedCluster&gt;::const_iterator c2 = cluster_list.begin();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            ++c1;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">while</span> (c1 != cluster_list.end())</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;              <span class="keywordtype">double</span> centre1x = (*c1).getCentre().getX();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;              <span class="keywordtype">double</span> centre1y = (*c1).getCentre().getY();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;              <span class="keywordtype">double</span> centre2x = (*c2).getCentre().getX();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;              <span class="keywordtype">double</span> centre2y = (*c2).getCentre().getY();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;              <span class="keywordtype">double</span> box1x_min = (*c1).getBoundingBox().minX();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;              <span class="keywordtype">double</span> box1x_max = (*c1).getBoundingBox().maxX();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;              <span class="keywordtype">double</span> box1y_min = (*c1).getBoundingBox().minY();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;              <span class="keywordtype">double</span> box1y_max = (*c1).getBoundingBox().maxY();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;              <span class="keywordtype">double</span> box2x_min = (*c2).getBoundingBox().minX();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;              <span class="keywordtype">double</span> box2x_max = (*c2).getBoundingBox().maxX();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;              <span class="keywordtype">double</span> box2y_min = (*c2).getBoundingBox().minY();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;              <span class="keywordtype">double</span> box2y_max = (*c2).getBoundingBox().maxY();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;              <span class="comment">//double y_range1 = box1y_max - box1y_min;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;              <span class="comment">//double y_range2 = box2y_max - box2y_min;</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;              <span class="comment">//double y_gap = box1y_min - box2y_max;</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;              <span class="comment">// Is there an overlap of the two clusters in x?</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;              <span class="keywordtype">bool</span> overlap = (box1x_min &lt;= box2x_max &amp;&amp; box1x_min &gt;= box2x_min) || (box1x_max &gt;= box2x_min &amp;&amp; box1x_max &lt;= box2x_max);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;              <span class="comment">// Is the x-centre of one cluster in the x-range of the other?</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;              <span class="comment">//bool centre_in_range1 = (box2x_min &lt;= centre1x &amp;&amp; centre1x &lt;= box2x_max);</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;              <span class="comment">//bool centre_in_range2 = (box1x_min &lt;= centre2x &amp;&amp; centre2x &lt;= box1x_max);</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;              <span class="comment">// Is the y-gap between the two clusters smaller than 1/s of their average y-range?</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;              <span class="comment">//double s = 6;    // scaling factor</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;              <span class="comment">//bool clusters_close = (y_gap * s &lt;= (y_range1 - y_range2)/2);</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;              <span class="comment">// Shall we merge the two adjacent clusters?</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;              <span class="comment">//if ((centre_in_range1 || centre_in_range2) &amp;&amp; clusters_close)</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;              <span class="keywordflow">if</span> (overlap)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;              {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                std::vector&lt;int&gt; points1 = (*c1).getPoints();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                std::vector&lt;int&gt; points2 = (*c2).getPoints();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                std::vector&lt;int&gt; new_points;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                new_points.reserve(points1.size() + points2.size());</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                new_points.insert(new_points.end(), points1.begin(), points1.end());</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                new_points.insert(new_points.end(), points2.begin(), points2.end());</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <span class="keywordtype">double</span> new_x = (centre1x * points1.size() + centre2x * points2.size()) / (points1.size() + points2.size());</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="keywordtype">double</span> new_y = (centre1y * points1.size() + centre2y * points2.size()) / (points1.size() + points2.size());</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <span class="keywordtype">double</span> min_x = std::min(box1x_min, box2x_min);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="keywordtype">double</span> min_y = std::min(box1y_min, box2y_min);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                <span class="keywordtype">double</span> max_x = std::max(box1x_max, box2x_max);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <span class="keywordtype">double</span> max_y = std::max(box1y_max, box2y_max);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <a class="code" href="a08601.html">Point</a> new_centre(new_x, new_y);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <a class="code" href="a08601.html">Point</a> position_min(min_x, min_y);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <a class="code" href="a08601.html">Point</a> position_max(max_x, max_y);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <a class="code" href="a08585.html">Rectangle</a> new_bounding_box(position_min, position_max);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <a class="code" href="a08185.html">GridBasedCluster</a> new_cluster(new_centre, new_bounding_box, new_points);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="comment">// update final cluster list</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.erase(<a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.find(index_list.find(*c1)-&gt;second));</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.erase(<a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.find(index_list.find(*c2)-&gt;second));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.insert(std::make_pair(index_list.find(*c1)-&gt;second, new_cluster));</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="comment">// update grid</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <a class="code" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">CellIndex</a> cell_for_cluster1 = grid_x_only.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>((*c1).getCentre());</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <a class="code" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">CellIndex</a> cell_for_cluster2 = grid_x_only.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>((*c2).getCentre());</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <a class="code" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">CellIndex</a> cell_for_new_cluster = grid_x_only.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>(new_centre);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                grid_x_only.<a class="code" href="a08173.html#a74e559158140500a4ecae778e2195975">removeCluster</a>(cell_for_cluster1, index_list.find(*c1)-&gt;second);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                grid_x_only.<a class="code" href="a08173.html#a74e559158140500a4ecae778e2195975">removeCluster</a>(cell_for_cluster2, index_list.find(*c2)-&gt;second);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                grid_x_only.<a class="code" href="a08173.html#ad0e46ab2050613d458b51dd5c6327baa">addCluster</a>(cell_for_new_cluster, index_list.find(*c1)-&gt;second);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;              }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;              ++c1;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;              ++c2;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;          }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="a08193.html#a157f8ca23b6c62f8931d3b04b0e2d2e4">  423</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a08193.html#a157f8ca23b6c62f8931d3b04b0e2d2e4">removeSmallClustersY</a>(<span class="keywordtype">double</span> threshold_y)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      std::map&lt;int, GridBasedCluster&gt;::iterator it = <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.begin();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keywordflow">while</span> (it != <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.end())</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <a class="code" href="a08585.html">Rectangle</a> box = it-&gt;second.getBoundingBox();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">if</span> (box.<a class="code" href="a08593.html#a7c9c9d073522f05622df5937a730b06b">maxY</a>() - box.<a class="code" href="a08593.html#afb3ad562a54f153a46d719b0c786b3ed">minY</a>() &lt; threshold_y)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;          <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.erase(it++);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          ++it;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="a08193.html#ae8346ab074b4a4544c74bb4689d64f99">  443</a></span>&#160;    std::map&lt;int, GridBasedCluster&gt; <a class="code" href="a08193.html#ae8346ab074b4a4544c74bb4689d64f99">getResults</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="a08193.html#a5875dbbf48510a2396ad20046746221a">  453</a></span>&#160;    Metric <a class="code" href="a08193.html#a5875dbbf48510a2396ad20046746221a">metric_</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">  459</a></span>&#160;    <a class="code" href="a08173.html">ClusteringGrid</a> <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">  465</a></span>&#160;    std::map&lt;int, GridBasedCluster&gt; <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="a08193.html#ace00051124c1463186d27c0ed54cca32">  471</a></span>&#160;    std::map&lt;int, GridBasedCluster&gt; <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="a08193.html#a7858bbd7bec5afb065a6eb652d8bf1db">  477</a></span>&#160;    std::multiset&lt;MinimumDistance&gt; <a class="code" href="a08193.html#a7858bbd7bec5afb065a6eb652d8bf1db">distances_</a>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="a08193.html#a9cd8423f72cbb43d29404e377c25c0bc">  483</a></span>&#160;    boost::unordered::unordered_multimap&lt;int, std::multiset&lt;MinimumDistance&gt;::const_iterator&gt; <a class="code" href="a08193.html#a9cd8423f72cbb43d29404e377c25c0bc">reverse_nns_</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="a08193.html#acfe2edce5b65c5c73e44cd7476105b8a">  489</a></span>&#160;    boost::unordered::unordered_map&lt;int, std::multiset&lt;MinimumDistance&gt;::const_iterator&gt; <a class="code" href="a08193.html#acfe2edce5b65c5c73e44cd7476105b8a">distance_it_for_cluster_idx_</a>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="a08193.html#a41f2c8be039fc59b05b033fd3e89583b">  499</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a08193.html#a41f2c8be039fc59b05b033fd3e89583b">init_</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; data_x, <span class="keyword">const</span> std::vector&lt;double&gt;&amp; data_y,</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;               <span class="keyword">const</span> std::vector&lt;int&gt;&amp; properties_A, <span class="keyword">const</span> std::vector&lt;int&gt;&amp; properties_B)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="comment">// fill the grid with points to be clustered (initially each cluster contains a single point)</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; data_x.size(); ++i)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <a class="code" href="a08601.html">Point</a> <a class="code" href="a05824.html#ad99d9cddae5d2494b71fffc770b02e28">position</a>(data_x[i], data_y[i]);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <a class="code" href="a08585.html">Rectangle</a> box(<a class="code" href="a05824.html#ad99d9cddae5d2494b71fffc770b02e28">position</a>, <a class="code" href="a05824.html#ad99d9cddae5d2494b71fffc770b02e28">position</a>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        std::vector&lt;int&gt; pi;        <span class="comment">// point indices</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        pi.push_back(i);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        std::vector&lt;int&gt; pb;        <span class="comment">// properties B</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        pb.push_back(properties_B[i]);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="comment">// add to cluster list</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <a class="code" href="a08185.html">GridBasedCluster</a> <a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a>(<a class="code" href="a05824.html#ad99d9cddae5d2494b71fffc770b02e28">position</a>, box, pi, properties_A[i], pb);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.insert(std::make_pair(i, <a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a>));</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="comment">// register on grid</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#ad0e46ab2050613d458b51dd5c6327baa">addCluster</a>(<a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>(<a class="code" href="a05824.html#ad99d9cddae5d2494b71fffc770b02e28">position</a>), i);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="comment">// fill list of minimum distances</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      std::map&lt;int, GridBasedCluster&gt;::iterator iterator = <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.begin();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keywordflow">while</span> (iterator != <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.end())</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordtype">int</span> cluster_index = iterator-&gt;first;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keyword">const</span> <a class="code" href="a08185.html">GridBasedCluster</a>&amp; <a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a> = iterator-&gt;second;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a08193.html#a1e03972a8a2312929b7660ab9d1b3adb">findNearestNeighbour_</a>(<a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a>, cluster_index))</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;          <span class="comment">// remove from grid</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;          <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a74e559158140500a4ecae778e2195975">removeCluster</a>(<a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>(<a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a>.getCentre()), cluster_index);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;          <span class="comment">// remove from cluster list</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;          <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.erase(iterator++);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;          ++iterator;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno"><a class="line" href="a08193.html#a36577ce9a1b73a448d440fdebab5f0ff">  555</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="a08193.html#a36577ce9a1b73a448d440fdebab5f0ff">mergeVeto_</a>(<span class="keyword">const</span> <a class="code" href="a08185.html">GridBasedCluster</a>&amp; c1, <span class="keyword">const</span> <a class="code" href="a08185.html">GridBasedCluster</a>&amp; c2)<span class="keyword"> const</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordtype">int</span> A1 = c1.<a class="code" href="a08185.html#aaea75303b47c6f0f0f37f65116233680">getPropertyA</a>();</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="keywordtype">int</span> A2 = c2.<a class="code" href="a08185.html#aaea75303b47c6f0f0f37f65116233680">getPropertyA</a>();</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="comment">// check if properties A of both clusters is set or not (not set := -1)</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keywordflow">if</span> (A1 == -1 || A2 == -1)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">// Will the merged cluster have the same properties A?</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">if</span> (A1 != A2) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      std::vector&lt;int&gt; B1 = c1.<a class="code" href="a08185.html#a967a97ae2e29a2ebbbcca29b75018e22">getPropertiesB</a>();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      std::vector&lt;int&gt; B2 = c2.<a class="code" href="a08185.html#a967a97ae2e29a2ebbbcca29b75018e22">getPropertiesB</a>();</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="comment">// check if properties B of both clusters is set or not (not set := -1)</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="a05824.html#a72f572bfef42558dd2ff5b133934dc0f">std::find</a>(B1.begin(), B1.end(), -1) != B1.end() || <a class="code" href="a05824.html#a72f572bfef42558dd2ff5b133934dc0f">std::find</a>(B2.begin(), B2.end(), -1) != B2.end())</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="comment">// Will the merged cluster have different properties B?</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="comment">// (Hence the intersection of properties B of cluster 1 and cluster 2 should be empty.)</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      std::vector&lt;int&gt; B_intersection;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      sort(B1.begin(), B1.end());</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      sort(B2.begin(), B2.end());</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      set_intersection(B1.begin(), B1.end(), B2.begin(), B2.end(), back_inserter(B_intersection));</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">return</span> !B_intersection.empty();</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="a08193.html#a1e03972a8a2312929b7660ab9d1b3adb">  601</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="a08193.html#a1e03972a8a2312929b7660ab9d1b3adb">findNearestNeighbour_</a>(<span class="keyword">const</span> <a class="code" href="a08185.html">GridBasedCluster</a>&amp; <a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a>, <span class="keywordtype">int</span> cluster_index)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keyword">const</span> <a class="code" href="a08601.html">Point</a>&amp; centre = <a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a>.getCentre();</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keyword">const</span> <a class="code" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">CellIndex</a>&amp; cell_index = <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">getIndex</a>(centre);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordtype">double</span> min_dist = 0;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordtype">int</span> nearest_neighbour = -1;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="comment">// search in the grid cell and its 8 neighbouring cells for the nearest neighbouring cluster</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = -1; i &lt;= 1; ++i)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = -1; j &lt;= 1; ++j)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <a class="code" href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">CellIndex</a> cell_index2(cell_index);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          cell_index2.first += i;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          cell_index2.second += j;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#acf78335e02d724c84dcff93dfa55c0d2">isNonEmptyCell</a>(cell_index2))</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keyword">const</span> std::list&lt;int&gt;&amp; cluster_indices = <a class="code" href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">grid_</a>.<a class="code" href="a08173.html#a7e681ee130060cce3f596859c74e8437">getClusters</a>(cell_index2);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">for</span> (std::list&lt;int&gt;::const_iterator cluster_index2 = cluster_indices.begin(); cluster_index2 != cluster_indices.end(); ++cluster_index2)</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;              <span class="keywordflow">if</span> (*cluster_index2 != cluster_index)</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;              {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="keyword">const</span> <a class="code" href="a08185.html">GridBasedCluster</a>&amp; cluster2 = <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.find(*cluster_index2)-&gt;second;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <span class="keyword">const</span> <a class="code" href="a08601.html">Point</a>&amp; centre2 = cluster2.<a class="code" href="a08185.html#a0c4342e729d0cb2a9692a103b92e7a32">getCentre</a>();</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="keywordtype">double</span> distance = <a class="code" href="a08193.html#a5875dbbf48510a2396ad20046746221a">metric_</a>(centre, centre2);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <span class="keywordflow">if</span> (distance &lt; min_dist || nearest_neighbour == -1)</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                  <span class="keywordtype">bool</span> veto = <a class="code" href="a08193.html#a36577ce9a1b73a448d440fdebab5f0ff">mergeVeto_</a>(<a class="code" href="a08193.html#a844bcda4813f21ce530f76e978bdb544">cluster</a>, cluster2); <span class="comment">// If clusters cannot be merged anyhow, they are no nearest neighbours.</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                  <span class="keywordflow">if</span> (!veto)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                  {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                      min_dist = distance;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                      nearest_neighbour = *cluster_index2;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                  }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;              }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;          }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="keywordflow">if</span> (nearest_neighbour == -1)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="comment">// no other cluster nearby, hence move the cluster to the final results</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <a class="code" href="a08193.html#ace00051124c1463186d27c0ed54cca32">clusters_final_</a>.insert(std::make_pair(cluster_index, <a class="code" href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">clusters_</a>.find(cluster_index)-&gt;second));</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="comment">// add to the list of minimal distances</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      std::multiset&lt;MinimumDistance&gt;::const_iterator it = <a class="code" href="a08193.html#a7858bbd7bec5afb065a6eb652d8bf1db">distances_</a>.insert(<a class="code" href="a08189.html">MinimumDistance</a>(cluster_index, nearest_neighbour, min_dist));</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="comment">// add to reverse nearest neighbor lookup table</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <a class="code" href="a08193.html#a9cd8423f72cbb43d29404e377c25c0bc">reverse_nns_</a>.insert(std::make_pair(nearest_neighbour, it));</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="comment">// add to cluster index -&gt; distance lookup table</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <a class="code" href="a08193.html#acfe2edce5b65c5c73e44cd7476105b8a">distance_it_for_cluster_idx_</a>[cluster_index] = it;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno"><a class="line" href="a08193.html#adf52b1cf6be20a08fc74a40e2f486e62">  668</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a08193.html#adf52b1cf6be20a08fc74a40e2f486e62">eraseMinDistance_</a>(<span class="keyword">const</span> std::multiset&lt;MinimumDistance&gt;::const_iterator it)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="comment">// remove corresponding entries from nearest neighbor lookup table</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      std::pair&lt;NNIterator, NNIterator&gt; nn_range = <a class="code" href="a08193.html#a9cd8423f72cbb43d29404e377c25c0bc">reverse_nns_</a>.equal_range(it-&gt;getNearestNeighbourIndex());</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="a08193.html#a60f3132df3f96e0b313d66c73c2a352b">NNIterator</a> nn_it = nn_range.first; nn_it != nn_range.second; ++nn_it)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">if</span> (nn_it-&gt;second == it)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;          <a class="code" href="a08193.html#a9cd8423f72cbb43d29404e377c25c0bc">reverse_nns_</a>.erase(nn_it);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="comment">// remove corresponding entry from cluster index -&gt; distance lookup table</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <a class="code" href="a08193.html#acfe2edce5b65c5c73e44cd7476105b8a">distance_it_for_cluster_idx_</a>.erase(it-&gt;getClusterIndex());</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="comment">// remove from distances_</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <a class="code" href="a08193.html#a7858bbd7bec5afb065a6eb652d8bf1db">distances_</a>.erase(it);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  };</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aa05822_html_a0f52d4afe25030292dc9f700abb34a20"><div class="ttname"><a href="a05822.html#a0f52d4afe25030292dc9f700abb34a20">OpenMS::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(const MultiplexDeltaMasses &amp;dm1, const MultiplexDeltaMasses &amp;dm2)</div></div>
<div class="ttc" id="aa03521_html"><div class="ttname"><a href="a03521.html">ProgressLogger.h</a></div></div>
<div class="ttc" id="aa08193_html_abb18a014484c80b14f684ca816cfd3cb"><div class="ttname"><a href="a08193.html#abb18a014484c80b14f684ca816cfd3cb">OpenMS::GridBasedClustering::MultisetIterator</a></div><div class="ttdeci">std::multiset&lt; MinimumDistance &gt;::const_iterator MultisetIterator</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:135</div></div>
<div class="ttc" id="aa08193_html_ace00051124c1463186d27c0ed54cca32"><div class="ttname"><a href="a08193.html#ace00051124c1463186d27c0ed54cca32">OpenMS::GridBasedClustering::clusters_final_</a></div><div class="ttdeci">std::map&lt; int, GridBasedCluster &gt; clusters_final_</div><div class="ttdoc">list of final clusters i.e. clusters that are no longer merged</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:471</div></div>
<div class="ttc" id="aa03428_html"><div class="ttname"><a href="a03428.html">GridBasedCluster.h</a></div></div>
<div class="ttc" id="aa08593_html_aff675c00c7f2dd6d38c5deefb4b4525e"><div class="ttname"><a href="a08593.html#aff675c00c7f2dd6d38c5deefb4b4525e">OpenMS::Internal::DIntervalBase::minPosition</a></div><div class="ttdeci">PositionType const  &amp; minPosition() const</div><div class="ttdoc">Accessor to minimum position.</div><div class="ttdef"><b>Definition:</b> DIntervalBase.h:124</div></div>
<div class="ttc" id="aa08173_html_acf78335e02d724c84dcff93dfa55c0d2"><div class="ttname"><a href="a08173.html#acf78335e02d724c84dcff93dfa55c0d2">OpenMS::ClusteringGrid::isNonEmptyCell</a></div><div class="ttdeci">bool isNonEmptyCell(const CellIndex &amp;cell_index) const</div><div class="ttdoc">checks if there are clusters at this cell index</div></div>
<div class="ttc" id="aa08173_html_a7e681ee130060cce3f596859c74e8437"><div class="ttname"><a href="a08173.html#a7e681ee130060cce3f596859c74e8437">OpenMS::ClusteringGrid::getClusters</a></div><div class="ttdeci">std::list&lt; int &gt; getClusters(const CellIndex &amp;cell_index) const</div><div class="ttdoc">returns clusters in this grid cell</div></div>
<div class="ttc" id="aa08173_html_aa45686cce9f5e30877fad4315027fcba"><div class="ttname"><a href="a08173.html#aa45686cce9f5e30877fad4315027fcba">OpenMS::ClusteringGrid::getGridSpacingY</a></div><div class="ttdeci">std::vector&lt; double &gt; getGridSpacingY() const</div><div class="ttdoc">returns grid spacing in y direction</div></div>
<div class="ttc" id="aa08193_html_ae0324d6f05c59a83bea4215f275a03a6"><div class="ttname"><a href="a08193.html#ae0324d6f05c59a83bea4215f275a03a6">OpenMS::GridBasedClustering::CellIndex</a></div><div class="ttdeci">ClusteringGrid::CellIndex CellIndex</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:134</div></div>
<div class="ttc" id="aa08193_html_a1e03972a8a2312929b7660ab9d1b3adb"><div class="ttname"><a href="a08193.html#a1e03972a8a2312929b7660ab9d1b3adb">OpenMS::GridBasedClustering::findNearestNeighbour_</a></div><div class="ttdeci">bool findNearestNeighbour_(const GridBasedCluster &amp;cluster, int cluster_index)</div><div class="ttdoc">determines the nearest neighbour for each cluster</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:601</div></div>
<div class="ttc" id="aa05782_html_gaf9ecec2d692138fab9167164a457cbd4"><div class="ttname"><a href="a05782.html#gaf9ecec2d692138fab9167164a457cbd4">OpenMS::Size</a></div><div class="ttdeci">size_t Size</div><div class="ttdoc">Size type e.g. used as variable which can hold result of size()</div><div class="ttdef"><b>Definition:</b> Types.h:127</div></div>
<div class="ttc" id="aa08313_html"><div class="ttname"><a href="a08313.html">OpenMS::Exception::InvalidValue</a></div><div class="ttdoc">Invalid value exception.</div><div class="ttdef"><b>Definition:</b> Exception.h:335</div></div>
<div class="ttc" id="aa08481_html_a6ca049c9417a2a648b4d41aec766d56b"><div class="ttname"><a href="a08481.html#a6ca049c9417a2a648b4d41aec766d56b">OpenMS::ProgressLogger::startProgress</a></div><div class="ttdeci">void startProgress(SignedSize begin, SignedSize end, const String &amp;label) const</div><div class="ttdoc">Initializes the progress display.</div></div>
<div class="ttc" id="aa05830_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="a05830.html#a8fc6defe4e499b1b9b9c275689e44352">OpenMS::Constants::c</a></div><div class="ttdeci">const double c</div></div>
<div class="ttc" id="aa08481_html"><div class="ttname"><a href="a08481.html">OpenMS::ProgressLogger</a></div><div class="ttdoc">Base class for all classes that want to report their progress.</div><div class="ttdef"><b>Definition:</b> ProgressLogger.h:54</div></div>
<div class="ttc" id="aa08193_html_a5e59fdae97df627825d720215c4bfbba"><div class="ttname"><a href="a08193.html#a5e59fdae97df627825d720215c4bfbba">OpenMS::GridBasedClustering::GridBasedClustering</a></div><div class="ttdeci">GridBasedClustering(Metric metric, const std::vector&lt; double &gt; &amp;data_x, const std::vector&lt; double &gt; &amp;data_y, std::vector&lt; double &gt; grid_spacing_x, std::vector&lt; double &gt; grid_spacing_y)</div><div class="ttdoc">initialises all data structures</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:166</div></div>
<div class="ttc" id="aa08185_html_a967a97ae2e29a2ebbbcca29b75018e22"><div class="ttname"><a href="a08185.html#a967a97ae2e29a2ebbbcca29b75018e22">OpenMS::GridBasedCluster::getPropertiesB</a></div><div class="ttdeci">const std::vector&lt; int &gt; &amp; getPropertiesB() const</div><div class="ttdoc">returns properties B of all points</div></div>
<div class="ttc" id="aa08593_html_afb3ad562a54f153a46d719b0c786b3ed"><div class="ttname"><a href="a08593.html#afb3ad562a54f153a46d719b0c786b3ed">OpenMS::Internal::DIntervalBase::minY</a></div><div class="ttdeci">CoordinateType minY() const</div><div class="ttdoc">Accessor for max_ coordinate minimum.</div><div class="ttdef"><b>Definition:</b> DIntervalBase.h:249</div></div>
<div class="ttc" id="aa08185_html_a522a3996eb8a004dbfe839107f3a2e89"><div class="ttname"><a href="a08185.html#a522a3996eb8a004dbfe839107f3a2e89">OpenMS::GridBasedCluster::getPoints</a></div><div class="ttdeci">const std::vector&lt; int &gt; &amp; getPoints() const</div><div class="ttdoc">returns indices of points in cluster</div></div>
<div class="ttc" id="aa08185_html_aaea75303b47c6f0f0f37f65116233680"><div class="ttname"><a href="a08185.html#aaea75303b47c6f0f0f37f65116233680">OpenMS::GridBasedCluster::getPropertyA</a></div><div class="ttdeci">int getPropertyA() const</div><div class="ttdoc">returns property A</div></div>
<div class="ttc" id="aa08593_html_a7c9c9d073522f05622df5937a730b06b"><div class="ttname"><a href="a08593.html#a7c9c9d073522f05622df5937a730b06b">OpenMS::Internal::DIntervalBase::maxY</a></div><div class="ttdeci">CoordinateType maxY() const</div><div class="ttdoc">Accessor for max_ coordinate maximum.</div><div class="ttdef"><b>Definition:</b> DIntervalBase.h:261</div></div>
<div class="ttc" id="aa05824_html_a72f572bfef42558dd2ff5b133934dc0f"><div class="ttname"><a href="a05824.html#a72f572bfef42558dd2ff5b133934dc0f">seqan::find</a></div><div class="ttdeci">bool find(TFinder &amp;finder, const Pattern&lt; TNeedle, FuzzyAC &gt; &amp;me, PatternAuxData&lt; TNeedle &gt; &amp;dh)</div><div class="ttdef"><b>Definition:</b> AhoCorasickAmbiguous.h:884</div></div>
<div class="ttc" id="aa04259_html"><div class="ttname"><a href="a04259.html">StandardTypes.h</a></div></div>
<div class="ttc" id="aa08193_html_a48ceb9a01e80ee721ec44179c9b5c674"><div class="ttname"><a href="a08193.html#a48ceb9a01e80ee721ec44179c9b5c674">OpenMS::GridBasedClustering::extendClustersY</a></div><div class="ttdeci">void extendClustersY()</div><div class="ttdoc">extends clusters in y-direction if possible (merges clusters further in y-direction,...</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:296</div></div>
<div class="ttc" id="aa08173_html_aa229a5292c096089f510cff1d8d1d064"><div class="ttname"><a href="a08173.html#aa229a5292c096089f510cff1d8d1d064">OpenMS::ClusteringGrid::CellIndex</a></div><div class="ttdeci">std::pair&lt; int, int &gt; CellIndex</div><div class="ttdef"><b>Definition:</b> ClusteringGrid.h:62</div></div>
<div class="ttc" id="aa08189_html_ad626c517ad932ce507e206046911b806"><div class="ttname"><a href="a08189.html#ad626c517ad932ce507e206046911b806">OpenMS::MinimumDistance::distance_</a></div><div class="ttdeci">double distance_</div><div class="ttdoc">distance between cluster and its nearest neighbour</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:105</div></div>
<div class="ttc" id="aa08189_html"><div class="ttname"><a href="a08189.html">OpenMS::MinimumDistance</a></div><div class="ttdoc">basic data structure for distances between clusters</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:60</div></div>
<div class="ttc" id="aa08193_html_a157f8ca23b6c62f8931d3b04b0e2d2e4"><div class="ttname"><a href="a08193.html#a157f8ca23b6c62f8931d3b04b0e2d2e4">OpenMS::GridBasedClustering::removeSmallClustersY</a></div><div class="ttdeci">void removeSmallClustersY(double threshold_y)</div><div class="ttdoc">removes clusters with bounding box dimension in y-direction below certain threshold</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:423</div></div>
<div class="ttc" id="aa08193_html_a420385f760e768e60145d1b5e00ffeb4"><div class="ttname"><a href="a08193.html#a420385f760e768e60145d1b5e00ffeb4">OpenMS::GridBasedClustering::grid_</a></div><div class="ttdeci">ClusteringGrid grid_</div><div class="ttdoc">grid on which the position of the clusters are registered used in cluster method</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:459</div></div>
<div class="ttc" id="aa08193_html_a60f3132df3f96e0b313d66c73c2a352b"><div class="ttname"><a href="a08193.html#a60f3132df3f96e0b313d66c73c2a352b">OpenMS::GridBasedClustering::NNIterator</a></div><div class="ttdeci">boost::unordered::unordered_multimap&lt; int, MultisetIterator &gt;::const_iterator NNIterator</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:136</div></div>
<div class="ttc" id="aa05824_html_ad99d9cddae5d2494b71fffc770b02e28"><div class="ttname"><a href="a05824.html#ad99d9cddae5d2494b71fffc770b02e28">seqan::position</a></div><div class="ttdeci">Size&lt; TNeedle &gt;::Type position(const PatternAuxData&lt; TNeedle &gt; &amp;dh)</div><div class="ttdef"><b>Definition:</b> AhoCorasickAmbiguous.h:561</div></div>
<div class="ttc" id="aa03605_html"><div class="ttname"><a href="a03605.html">DRange.h</a></div></div>
<div class="ttc" id="aa08193_html_acfe2edce5b65c5c73e44cd7476105b8a"><div class="ttname"><a href="a08193.html#acfe2edce5b65c5c73e44cd7476105b8a">OpenMS::GridBasedClustering::distance_it_for_cluster_idx_</a></div><div class="ttdeci">boost::unordered::unordered_map&lt; int, std::multiset&lt; MinimumDistance &gt;::const_iterator &gt; distance_it_for_cluster_idx_</div><div class="ttdoc">cluster index to distance iterator lookup table for finding out which clusters need to be updated fas...</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:489</div></div>
<div class="ttc" id="aa08193_html"><div class="ttname"><a href="a08193.html">OpenMS::GridBasedClustering</a></div><div class="ttdoc">2D hierarchical clustering implementation optimized for large data sets containing many small cluster...</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:125</div></div>
<div class="ttc" id="aa08769_html"><div class="ttname"><a href="a08769.html">OpenMS::String</a></div><div class="ttdoc">A more convenient string class.</div><div class="ttdef"><b>Definition:</b> String.h:58</div></div>
<div class="ttc" id="aa08193_html_a36577ce9a1b73a448d440fdebab5f0ff"><div class="ttname"><a href="a08193.html#a36577ce9a1b73a448d440fdebab5f0ff">OpenMS::GridBasedClustering::mergeVeto_</a></div><div class="ttdeci">bool mergeVeto_(const GridBasedCluster &amp;c1, const GridBasedCluster &amp;c2) const</div><div class="ttdoc">checks if two clusters can be merged Each point in a cluster can (optionally) have two properties A a...</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:555</div></div>
<div class="ttc" id="aa08185_html"><div class="ttname"><a href="a08185.html">OpenMS::GridBasedCluster</a></div><div class="ttdoc">basic data structure for clustering</div><div class="ttdef"><b>Definition:</b> GridBasedCluster.h:55</div></div>
<div class="ttc" id="aa08585_html"><div class="ttname"><a href="a08585.html">OpenMS::DBoundingBox&lt; 2 &gt;</a></div></div>
<div class="ttc" id="aa08193_html_ac468fe99f9ed1ccf10792f3d7b420905"><div class="ttname"><a href="a08193.html#ac468fe99f9ed1ccf10792f3d7b420905">OpenMS::GridBasedClustering::clusters_</a></div><div class="ttdeci">std::map&lt; int, GridBasedCluster &gt; clusters_</div><div class="ttdoc">list of clusters maps cluster indices to clusters</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:465</div></div>
<div class="ttc" id="aa08173_html"><div class="ttname"><a href="a08173.html">OpenMS::ClusteringGrid</a></div><div class="ttdoc">data structure to store 2D data to be clustered e.g. (m/z, retention time) coordinates from multiplex...</div><div class="ttdef"><b>Definition:</b> ClusteringGrid.h:56</div></div>
<div class="ttc" id="aa08601_html_aa83259652f0c977f7d2d246474f4afde"><div class="ttname"><a href="a08601.html#aa83259652f0c977f7d2d246474f4afde">OpenMS::DPosition::getX</a></div><div class="ttdeci">CoordinateType getX() const</div><div class="ttdoc">Name accessor for the first dimension. Only for DPosition&lt;2&gt;, for visualization.</div><div class="ttdef"><b>Definition:</b> DPosition.h:157</div></div>
<div class="ttc" id="aa05835_html_a69356adacc066d0db0e0ec87c0da1c2c"><div class="ttname"><a href="a05835.html#a69356adacc066d0db0e0ec87c0da1c2c">KDTree::operator==</a></div><div class="ttdeci">bool operator==(_Iterator&lt; _Val, _Ref, _Ptr &gt; const &amp;, _Iterator&lt; _Val, _Ref, _Ptr &gt; const &amp;)</div><div class="ttdef"><b>Definition:</b> KDTree.h:806</div></div>
<div class="ttc" id="aa08481_html_ab11bd2bba91e2c1055b2eeb376a25d0e"><div class="ttname"><a href="a08481.html#ab11bd2bba91e2c1055b2eeb376a25d0e">OpenMS::ProgressLogger::endProgress</a></div><div class="ttdeci">void endProgress() const</div><div class="ttdoc">Ends the progress display.</div></div>
<div class="ttc" id="aa08481_html_a05d564f4a203341c9f1b1e6c8ec1068d"><div class="ttname"><a href="a08481.html#a05d564f4a203341c9f1b1e6c8ec1068d">OpenMS::ProgressLogger::setProgress</a></div><div class="ttdeci">void setProgress(SignedSize value) const</div><div class="ttdoc">Sets the current progress.</div></div>
<div class="ttc" id="aa08193_html_ae8346ab074b4a4544c74bb4689d64f99"><div class="ttname"><a href="a08193.html#ae8346ab074b4a4544c74bb4689d64f99">OpenMS::GridBasedClustering::getResults</a></div><div class="ttdeci">std::map&lt; int, GridBasedCluster &gt; getResults() const</div><div class="ttdoc">returns final results (mapping of cluster indices to clusters)</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:443</div></div>
<div class="ttc" id="aa08193_html_a844bcda4813f21ce530f76e978bdb544"><div class="ttname"><a href="a08193.html#a844bcda4813f21ce530f76e978bdb544">OpenMS::GridBasedClustering::cluster</a></div><div class="ttdeci">void cluster()</div><div class="ttdoc">performs the hierarchical clustering (merges clusters until their dimension exceeds that of cell)</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:182</div></div>
<div class="ttc" id="aa08193_html_a7f20c535c41ab740421ffa604372b6ae"><div class="ttname"><a href="a08193.html#a7f20c535c41ab740421ffa604372b6ae">OpenMS::GridBasedClustering::GridBasedClustering</a></div><div class="ttdeci">GridBasedClustering(Metric metric, const std::vector&lt; double &gt; &amp;data_x, const std::vector&lt; double &gt; &amp;data_y, const std::vector&lt; int &gt; &amp;properties_A, const std::vector&lt; int &gt; &amp;properties_B, std::vector&lt; double &gt; grid_spacing_x, std::vector&lt; double &gt; grid_spacing_y)</div><div class="ttdoc">initialises all data structures</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:148</div></div>
<div class="ttc" id="aa03419_html"><div class="ttname"><a href="a03419.html">ClusteringGrid.h</a></div></div>
<div class="ttc" id="aa08173_html_ad0e46ab2050613d458b51dd5c6327baa"><div class="ttname"><a href="a08173.html#ad0e46ab2050613d458b51dd5c6327baa">OpenMS::ClusteringGrid::addCluster</a></div><div class="ttdeci">void addCluster(const CellIndex &amp;cell_index, const int &amp;cluster_index)</div><div class="ttdoc">adds a cluster to this grid cell</div></div>
<div class="ttc" id="aa08173_html_a05720f680a5c22092963f9e33e78c199"><div class="ttname"><a href="a08173.html#a05720f680a5c22092963f9e33e78c199">OpenMS::ClusteringGrid::getGridSpacingX</a></div><div class="ttdeci">std::vector&lt; double &gt; getGridSpacingX() const</div><div class="ttdoc">returns grid spacing in x direction</div></div>
<div class="ttc" id="aa08193_html_a7858bbd7bec5afb065a6eb652d8bf1db"><div class="ttname"><a href="a08193.html#a7858bbd7bec5afb065a6eb652d8bf1db">OpenMS::GridBasedClustering::distances_</a></div><div class="ttdeci">std::multiset&lt; MinimumDistance &gt; distances_</div><div class="ttdoc">list of minimum distances stores the smallest of the distances in the head</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:477</div></div>
<div class="ttc" id="aa08593_html_a2bd69d0a4455fd82199e30ef42221625"><div class="ttname"><a href="a08593.html#a2bd69d0a4455fd82199e30ef42221625">OpenMS::Internal::DIntervalBase::maxPosition</a></div><div class="ttdeci">PositionType const  &amp; maxPosition() const</div><div class="ttdoc">Accessor to maximum position.</div><div class="ttdef"><b>Definition:</b> DIntervalBase.h:130</div></div>
<div class="ttc" id="aa08601_html_a80ab217ffe70d98ca6480e04083e28f2"><div class="ttname"><a href="a08601.html#a80ab217ffe70d98ca6480e04083e28f2">OpenMS::DPosition::getY</a></div><div class="ttdeci">CoordinateType getY() const</div><div class="ttdoc">Name accessor for the second dimension. Only for DPosition&lt;2&gt;, for visualization.</div><div class="ttdef"><b>Definition:</b> DPosition.h:164</div></div>
<div class="ttc" id="aa03650_html"><div class="ttname"><a href="a03650.html">String.h</a></div></div>
<div class="ttc" id="aa08601_html"><div class="ttname"><a href="a08601.html">OpenMS::DPosition&lt; 2 &gt;</a></div></div>
<div class="ttc" id="aa08193_html_a5875dbbf48510a2396ad20046746221a"><div class="ttname"><a href="a08193.html#a5875dbbf48510a2396ad20046746221a">OpenMS::GridBasedClustering::metric_</a></div><div class="ttdeci">Metric metric_</div><div class="ttdoc">metric for measuring the distance between points in the 2D plane</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:453</div></div>
<div class="ttc" id="aa08173_html_a62d76c7c0f6dc951ea516f8f2ca1598b"><div class="ttname"><a href="a08173.html#a62d76c7c0f6dc951ea516f8f2ca1598b">OpenMS::ClusteringGrid::getIndex</a></div><div class="ttdeci">CellIndex getIndex(const Point &amp;position) const</div><div class="ttdoc">returns grid cell index (i,j) for the positions (x,y)</div></div>
<div class="ttc" id="aa08185_html_a0c4342e729d0cb2a9692a103b92e7a32"><div class="ttname"><a href="a08185.html#a0c4342e729d0cb2a9692a103b92e7a32">OpenMS::GridBasedCluster::getCentre</a></div><div class="ttdeci">const Point &amp; getCentre() const</div><div class="ttdoc">returns cluster centre</div></div>
<div class="ttc" id="aa08173_html_a74e559158140500a4ecae778e2195975"><div class="ttname"><a href="a08173.html#a74e559158140500a4ecae778e2195975">OpenMS::ClusteringGrid::removeCluster</a></div><div class="ttdeci">void removeCluster(const CellIndex &amp;cell_index, const int &amp;cluster_index)</div><div class="ttdoc">removes a cluster from this grid cell and removes the cell if no other cluster left</div></div>
<div class="ttc" id="aa08193_html_adf52b1cf6be20a08fc74a40e2f486e62"><div class="ttname"><a href="a08193.html#adf52b1cf6be20a08fc74a40e2f486e62">OpenMS::GridBasedClustering::eraseMinDistance_</a></div><div class="ttdeci">void eraseMinDistance_(const std::multiset&lt; MinimumDistance &gt;::const_iterator it)</div><div class="ttdoc">remove minimum distance object and its related data</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:668</div></div>
<div class="ttc" id="aa08193_html_a7236c907144321148d78f708da14d74a"><div class="ttname"><a href="a08193.html#a7236c907144321148d78f708da14d74a">OpenMS::GridBasedClustering::Rectangle</a></div><div class="ttdeci">GridBasedCluster::Rectangle Rectangle</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:133</div></div>
<div class="ttc" id="aa08193_html_a9cd8423f72cbb43d29404e377c25c0bc"><div class="ttname"><a href="a08193.html#a9cd8423f72cbb43d29404e377c25c0bc">OpenMS::GridBasedClustering::reverse_nns_</a></div><div class="ttdeci">boost::unordered::unordered_multimap&lt; int, std::multiset&lt; MinimumDistance &gt;::const_iterator &gt; reverse_nns_</div><div class="ttdoc">reverse nearest neighbor lookup table for finding out which clusters need to be updated faster</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:483</div></div>
<div class="ttc" id="aa08193_html_a8e9a85a0b07b50d2167de474edad2359"><div class="ttname"><a href="a08193.html#a8e9a85a0b07b50d2167de474edad2359">OpenMS::GridBasedClustering::Point</a></div><div class="ttdeci">GridBasedCluster::Point Point</div><div class="ttdoc">cluster centre, cluster bounding box, grid index</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:132</div></div>
<div class="ttc" id="aa08193_html_a41f2c8be039fc59b05b033fd3e89583b"><div class="ttname"><a href="a08193.html#a41f2c8be039fc59b05b033fd3e89583b">OpenMS::GridBasedClustering::init_</a></div><div class="ttdeci">void init_(const std::vector&lt; double &gt; &amp;data_x, const std::vector&lt; double &gt; &amp;data_y, const std::vector&lt; int &gt; &amp;properties_A, const std::vector&lt; int &gt; &amp;properties_B)</div><div class="ttdoc">initialises all data structures</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:499</div></div>
<div class="ttc" id="aa08185_html_aa2cc373c1f3f903c637fef88fa44984d"><div class="ttname"><a href="a08185.html#aa2cc373c1f3f903c637fef88fa44984d">OpenMS::GridBasedCluster::getBoundingBox</a></div><div class="ttdeci">const Rectangle &amp; getBoundingBox() const</div><div class="ttdoc">returns bounding box</div></div>
<div class="ttc" id="aa08189_html_a78425958789b6bba9b118e1dd8135f7d"><div class="ttname"><a href="a08189.html#a78425958789b6bba9b118e1dd8135f7d">OpenMS::MinimumDistance::nearest_neighbour_index_</a></div><div class="ttdeci">int nearest_neighbour_index_</div><div class="ttdoc">index of the nearest neighbour of the above cluster</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:100</div></div>
<div class="ttc" id="aa08189_html_ae24a71e258cf35ccf7e66a5bd079b2bd"><div class="ttname"><a href="a08189.html#ae24a71e258cf35ccf7e66a5bd079b2bd">OpenMS::MinimumDistance::cluster_index_</a></div><div class="ttdeci">int cluster_index_</div><div class="ttdoc">index in the cluster list</div><div class="ttdef"><b>Definition:</b> GridBasedClustering.h:95</div></div>
<div class="ttc" id="aa05822_html"><div class="ttname"><a href="a05822.html">OpenMS</a></div><div class="ttdoc">Main OpenMS namespace.</div><div class="ttdef"><b>Definition:</b> FeatureDeconvolution.h:46</div></div>
<div class="ttc" id="aa08585_html_af8aceaf27078e216608a86572079213a"><div class="ttname"><a href="a08585.html#af8aceaf27078e216608a86572079213a">OpenMS::DBoundingBox::enlarge</a></div><div class="ttdeci">void enlarge(const PositionType &amp;p)</div><div class="ttdoc">Enlarges the bounding box such that it contains a position.</div><div class="ttdef"><b>Definition:</b> DBoundingBox.h:121</div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 9 2019 15:06:02 for OpenMS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
